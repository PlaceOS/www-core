(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{Gwc7:function(e,t,n){"use strict";n.r(t);var c=n("fXoL"),i=n("ofXK"),s=n("3Pt+"),o=n("tyNb"),r=n("CcG0"),a=n("UN3I"),d=n("OaWH"),l=n("C/ya"),h=n("g+Po"),m=n("D/9M"),u=n("LcAk"),g=n("BAfr"),f=n("m6yr"),v=n("47y3"),b=n("5f3J"),p=n("Xlwt"),_=n("rUqb");const y=[1,"container"],w=[1,"flex"],C=[1,"class"],M=[1,"class","mono"],O=["mat-button","",3,"tapped"],P=[3,"ngModel","readonly"],I=(()=>{class e extends b.a{constructor(e,t){super(),this._dialog=e,this._service=t}get settings(){return this.item.settings.settings_string}reloadDriver(){if(this.item){const e=this._dialog.open(h.b,Object.assign({},h.a,{data:{title:"Reload Driver",content:"<p>Are you sure you want reload this driver?</p><p>New driver code will be loaded and device settings will be updated.</p>",icon:{type:"icon",class:"backoffice-cycle"}}}));this.subscription("delete_confirm",e.componentInstance.event.subscribe(t=>{"done"===t.reason&&(e.componentInstance.loading="Reloading driver...",this.item.reload().then(()=>{this._service.notifySuccess(`Successfully reloaded driver "${this.item.name}".`),e.close(),this.unsub("delete_confirm")},t=>{e.componentInstance.loading=null,this._service.notifyError(`Error reloading driver. Error: ${t}`)}))}))}}}return e.ngComponentDef=c.Rb({type:e,selectors:[["driver-about"]],factory:function(t){return new(t||e)(c.Xb(u.b),c.Xb(d.a))},inputs:{item:"item"},features:[c.Fb],consts:21,vars:4,template:function(e,t){1&e&&(c.ec(0,"div",y),c.ec(1,"section"),c.ec(2,"table"),c.ec(3,"thead"),c.ec(4,"td",w),c.Tc(5,"Module Name"),c.cc(),c.ec(6,"td",C),c.Tc(7,"Class"),c.cc(),c.cc(),c.ec(8,"tbody"),c.ec(9,"tr"),c.ec(10,"td",w),c.Tc(11),c.cc(),c.ec(12,"td",M),c.Tc(13),c.cc(),c.cc(),c.cc(),c.cc(),c.cc(),c.ec(14,"section"),c.ec(15,"button",O),c.kc("tapped",function(e){return t.reloadDriver()}),c.Tc(16,"Reload Modules"),c.cc(),c.cc(),c.ec(17,"header"),c.Tc(18,"Settings"),c.cc(),c.ec(19,"section"),c.Yb(20,"settings-form-field",P),c.cc(),c.cc()),2&e&&(c.Ic(11),c.Uc(null==t.item?null:t.item.module_name),c.Ic(13),c.Uc(null==t.item?null:t.item.class_name),c.Ic(20),c.vc("ngModel",t.settings)("readonly",!0))},directives:[p.b,f.b,_.a,s.k,s.n],styles:[".container[_ngcontent-%COMP%]{padding:1em}header[_ngcontent-%COMP%]{font-weight:700;font-size:1.1em}.table-row[_ngcontent-%COMP%]   .class[_ngcontent-%COMP%]{width:12em;min-width:12em}section[_ngcontent-%COMP%]{padding:.5em .25em}"]}),e})();var k=n("XNiG"),x=n("LRne"),D=n("Kj3r"),T=n("/uUt"),$=n("eIep"),j=n("JIr8"),E=n("lJxs"),R=n("IRfi"),X=n("0njA"),A=n("A2Vd");const S=[1,"container"],L=[1,"settings"],N=[1,"select"],U=["appearance","outline"],F=["matPrefix","",1,"prefix"],Y=[3,"icon"],q=["matInput","","name","search-filter","placeholder","Filter Devices",3,"ngModel","ngModelChange"],J=[1,"list"],G=[4,"ngIf"],V=["class","info-block",4,"ngIf"],z=[1,"small"],B=[1,"flex"],H=[1,"system"],W=[4,"ngFor","ngForOf"],K=[1,"state"],Q=["binding","","bind","connected",3,"model","sys","mod","modelChange"],Z=[3,"routerLink"],ee=[1,"id"],te=["mat-icon-button","",3,"tapped"],ne=[1,"backoffice-trash"],ce=function(e){return["/modules",e]},ie=function(e){return["/systems",e]};function se(e,t){if(1&e){const e=c.fc();c.ec(0,"tr"),c.ec(1,"td",z),c.ec(2,"div",K),c.Pc(),c.cc(),c.ec(3,"i",Q),c.kc("modelChange",function(n){return c.Ec(e),t.$implicit.enabled=n}),c.cc(),c.cc(),c.ec(4,"td",B),c.ec(5,"a",Z),c.Tc(6),c.cc(),c.cc(),c.ec(7,"td",H),c.ec(8,"a",Z),c.Tc(9),c.ec(10,"span",ee),c.Tc(11),c.cc(),c.Tc(12,") "),c.cc(),c.cc(),c.ec(13,"td",z),c.ec(14,"button",te),c.kc("tapped",function(n){c.Ec(e);const i=t.$implicit;return c.pc(2).removeDevice(i)}),c.Yb(15,"i",ne),c.cc(),c.cc(),c.cc()}if(2&e){const e=t.$implicit;c.Ic(2),c.Mb("active",e.enabled),c.Qc(),c.Ic(3),c.vc("model",e.enabled)("sys",e.system.id)("mod",e.module_name),c.Ic(5),c.vc("routerLink",c.wc(9,ce,e.id)),c.Ic(6),c.Uc(e.name),c.Ic(8),c.vc("routerLink",c.wc(11,ie,e.system.id)),c.Ic(9),c.Vc(" ",null==e.system?null:e.system.name," ("),c.Ic(11),c.Uc(null==e.system?null:e.system.id)}}function oe(e,t){if(1&e&&(c.ec(0,"table"),c.ec(1,"thead"),c.Yb(2,"td",z),c.ec(3,"td",B),c.Tc(4,"Name"),c.cc(),c.ec(5,"td",H),c.Tc(6,"System"),c.cc(),c.Yb(7,"td",z),c.cc(),c.ec(8,"tbody"),c.Rc(9,se,16,13,"tr",W),c.cc(),c.cc()),2&e){const e=c.pc();c.Ic(9),c.vc("ngForOf",e.device_list)}}const re=[1,"info-block"],ae=[1,"text"];function de(e,t){1&e&&(c.ec(0,"div",re),c.ec(1,"div",ae),c.Tc(2,"No devices with driver"),c.cc(),c.cc())}const le={class:"backoffice-magnifying-glass"},he=(()=>{class e extends b.a{constructor(e,t){super(),this._service=e,this._dialog=t,this.device_list=[],this.search$=new k.a}ngOnInit(){this.search_results$=this.search$.pipe(Object(D.a)(400),Object(T.a)(),Object($.a)(e=>(this.loading=!0,this._service.Modules.query({q:e,dependency_id:this.item.id,offset:0,limit:500}))),Object(j.a)(e=>(console.error(e),Object(x.a)([]))),Object(E.a)(e=>{this.loading=!1;const t=this.search_str.toLowerCase();return e.filter(e=>e.name.toLowerCase().indexOf(t)>=0||(e.email||"").toLowerCase().indexOf(t)>=0)})),this.subscription("search_results",this.search_results$.subscribe(e=>this.device_list=e))}ngOnChanges(e){e.item&&this.loadDevices()}loadDevices(e=0){this._service.Modules.query({dependency_id:this.item.id,offset:e,limit:500}).then(e=>this.device_list=e,()=>null)}removeDevice(e){if(e){const t=this._dialog.open(h.b,Object.assign({},h.a,{data:{title:"Delete device",content:"<p>Are you sure you want delete this device?</p><p>Deleting this will device <strong>immediately</strong> remove it from any system associated with it</p>",icon:{type:"icon",class:"backoffice-trash"}}}));this.subscription("delete_confirm",t.componentInstance.event.subscribe(n=>{"done"===n.reason&&(t.componentInstance.loading="Deleting device...",e.delete().then(()=>{this._service.notifySuccess(`Successfully deleted device "${e.name}".`),this.loadDevices(),t.close(),this.unsub("delete_confirm")},e=>{t.componentInstance.loading=null,this._service.notifyError(`Error deleting device. Error: ${e}`)}))}))}}}return e.ngComponentDef=c.Rb({type:e,selectors:[["driver-devices"]],factory:function(t){return new(t||e)(c.Xb(d.a),c.Xb(u.b))},inputs:{item:"item"},features:[c.Fb,c.Gb()],consts:10,vars:4,template:function(e,t){1&e&&(c.ec(0,"div",S),c.ec(1,"div",L),c.ec(2,"section",N),c.ec(3,"mat-form-field",U),c.ec(4,"div",F),c.Yb(5,"app-icon",Y),c.cc(),c.ec(6,"input",q),c.kc("ngModelChange",function(e){return t.search_str=e}),c.kc("ngModelChange",function(e){return t.search$.next(e)}),c.cc(),c.cc(),c.cc(),c.ec(7,"section",J),c.Rc(8,oe,10,1,"table",G),c.Rc(9,de,3,0,"div",V),c.cc(),c.cc(),c.cc()),2&e&&(c.Ic(5),c.vc("icon",le),c.Ic(6),c.vc("ngModel",t.search_str),c.Ic(8),c.vc("ngIf",t.device_list&&t.device_list.length>0),c.Ic(9),c.vc("ngIf",!t.device_list||t.device_list.length<=0))},directives:[R.b,R.e,X.a,A.a,s.b,s.k,s.n,i.n,i.m,r.a,o.f,p.b,f.b],styles:[".container[_ngcontent-%COMP%]{padding:1em}mat-form-field[_ngcontent-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:1.25em}.list[_ngcontent-%COMP%]{margin-top:.5em}.table-row[_ngcontent-%COMP%]   .system[_ngcontent-%COMP%]{width:12em;min-width:12em}.action[_ngcontent-%COMP%]{height:1.5em;width:1.5em;min-width:1.5em;border-radius:.65em;display:flex;align-items:center;justify-content:center;font-size:1.3em}.action[_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.1)}.state[_ngcontent-%COMP%]{height:1.5em;width:1.5em;margin:.25em;background-color:#000;border-radius:.8em;transition:margin 250ms,height 250ms,width 250ms,background-color .3s}.state.active[_ngcontent-%COMP%]{background-color:#4caf50;height:.75em;width:.75em;margin:.625em}.select[_ngcontent-%COMP%]{display:flex;align-items:center}.select[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{flex:1}"]}),e})(),me=[1,"container"],ue=[1,"sidebar"],ge=["heading","Drivers",3,"module","close","searchChange","event"],fe=[3,"touchrelease"],ve=["name","driver",3,"item","active","tabs","event"],be=["about",""],pe=["devices",""],_e=[3,"item"];function ye(e,t){if(1&e&&c.Yb(0,"driver-about",_e),2&e){const e=c.pc();c.vc("item",e.item)}}function we(e,t){if(1&e&&c.Yb(0,"driver-devices",_e),2&e){const e=c.pc();c.vc("item",e.item)}}const Ce={class:"backoffice-info-with-circle"},Me=function(e){return{id:"about",name:"About",template:e,icon:Ce}},Oe={class:"backoffice-tablet"},Pe=function(e,t){return{id:"devices",name:"Devices",template:e,count:t,icon:Oe}},Ie=function(e,t){return[e,t]},ke=(()=>{class e extends l.a{constructor(e,t,n,c){super(e,t,n),this._service=e,this._route=t,this._router=n,this._dialog=c,this.service=this._service.Drivers}loadValues(){this._service.Modules.query({offset:0,limit:1,dependency_id:this.item.id}).then(()=>{this.device_count=this._service.Modules.last_total||0})}new(){this._dialog.open(m.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:new a.f(this._service.Drivers,{}),service:this._service.Drivers}})}edit(){this.item&&this._dialog.open(m.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:this.item,service:this._service.Drivers}})}delete(){if(this.item){const e=this._dialog.open(h.b,Object.assign({},h.a,{data:{title:"Delete driver",content:"<p>Are you sure you want delete this driver?</p><p>All devices that rely on this driver will be <strong>immediately</strong> removed.</p>",icon:{type:"icon",class:"backoffice-trash"}}}));this.subscription("delete_confirm",e.componentInstance.event.subscribe(t=>{"done"===t.reason&&(e.componentInstance.loading="Deleting driver...",this.item.delete().then(()=>{this._service.notifySuccess(`Successfully deleted driver "${this.item.name}".`),this._router.navigate(["/drivers"]),e.close(),this.unsub("delete_confirm")},t=>{e.componentInstance.loading=null,this._service.notifyError(`Error deleting driver. Error: ${t}`)}))}))}}}return e.ngComponentDef=c.Rb({type:e,selectors:[["app-drivers"]],factory:function(t){return new(t||e)(c.Xb(d.a),c.Xb(o.a),c.Xb(o.c),c.Xb(u.b))},features:[c.Fb],consts:9,vars:14,template:function(e,t){if(1&e&&(c.ec(0,"div",me),c.Pc(),c.ec(1,"div",ue),c.ec(2,"sidebar",ge),c.kc("searchChange",function(e){return t.search(e)}),c.kc("event",function(e){return t.sidebarEvent(e)}),c.cc(),c.cc(),c.ec(3,"main",fe),c.kc("touchrelease",function(e){return t.show_sidebar=!1}),c.ec(4,"item-display",ve),c.kc("event",function(e){return t.itemEvent(e)}),c.Rc(5,ye,1,1,"ng-template",null,be,c.Sc),c.Rc(7,we,1,1,"ng-template",null,pe,c.Sc),c.cc(),c.cc(),c.cc()),2&e){const e=c.Bc(6),n=c.Bc(8);c.Mb("show",t.show_sidebar),c.Qc(),c.Ic(2),c.vc("module",t.module)("close",t.show_sidebar),c.Ic(4),c.vc("item",t.item)("active",t.tab)("tabs",c.xc(11,Ie,c.wc(6,Me,e),c.xc(8,Pe,n,t.device_count)))}},directives:[g.a,f.b,v.a,I,he],styles:[".container[_ngcontent-%COMP%]{display:flex;align-items:center;height:100%;width:100%}.sidebar[_ngcontent-%COMP%]{height:100%;width:20em}@media only screen and (orientation:portrait) and (max-width:450px){.container[_ngcontent-%COMP%]{flex-direction:column}.container.show[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{height:100%}.container.show[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{height:0%}.sidebar[_ngcontent-%COMP%]{height:3em;min-height:3em;width:100%;transition:height .3s}main[_ngcontent-%COMP%]{transition:height .3s;width:100%}}@media only screen and (orientation:landscape) and (max-width:800px){.container[_ngcontent-%COMP%]{flex-direction:column}.container.show[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{height:100%}.container.show[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{height:0%}.sidebar[_ngcontent-%COMP%]{height:3em;min-height:3em;width:100%;transition:height .3s}main[_ngcontent-%COMP%]{transition:height .3s;width:100%}}main[_ngcontent-%COMP%]{position:relative;height:100%;overflow:hidden;flex:1;background-color:#f0f0f0}"]}),e})(),xe=[{path:"",component:ke,children:[]},{path:":id",component:ke,children:[]},{path:"**",redirectTo:""}];var De=n("PCNd");n.d(t,"AppDriversModule",function(){return Te});const Te=(()=>{class e{}return e.ngModuleDef=c.Vb({type:e}),e.ngInjectorDef=c.Ub({factory:function(t){return new(t||e)},imports:[[i.c,s.g,r.b,o.g.forChild(xe),De.a]]}),e})();o.g.forChild(xe)}}]);