(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{wKJ7:function(e,t,n){"use strict";n.r(t);var i=n("fXoL"),c=n("ofXK"),o=n("3Pt+"),s=n("tyNb"),r=n("aCXV"),a=n("CcG0"),d=n("mrSG"),g=n("UN3I"),m=n("OaWH"),l=n("C/ya"),p=n("0IXN"),h=n("g+Po"),f=n("D/9M"),u=n("LcAk"),b=n("BAfr"),v=n("m6yr"),_=n("47y3"),y=n("5f3J"),C=n("xQV9"),O=n("mrP1"),w=n("gVAx"),I=n("GrRB"),P=n("Xlwt"),M=n("0njA"),k=n("8r66");const x=[1,"container"],T=[1,"settings"],R=[1,"field"],E=["for","dependency","matTooltip","System to use for available status variables and function calls"],A=[3,"service","ngModel","ngModelChange"],S=[1,"action"],$=["mat-icon-button","",3,"disabled","tapped"],D=[3,"icon"],F=[1,"text"],Y=["class","list",4,"ngIf","ngIfElse"],N=["no_conditions",""],X=["no_actions",""],j=[1,"list"],B=[1,"header"],J=[1,"group","comparisons"],L=["class","item",4,"ngFor","ngForOf","ngForTrackBy"],V=[1,"group","time-dependents"],q=[1,"item"],z=[1,"handle"],G=[1,"details"],W=["mat-icon-button","",3,"tapped"],H={class:"backoffice-edit"},U={class:"backoffice-trash"};function Q(e,t){if(1&e){const e=i.fc();i.ec(0,"div",q),i.Yb(1,"div",z),i.ec(2,"div",G),i.Tc(3),i.qc(4,"json"),i.qc(5,"json"),i.cc(),i.ec(6,"button",$),i.kc("tapped",function(n){i.Ec(e);const c=t.$implicit;return i.pc(2).editCondition(c)}),i.Yb(7,"app-icon",D),i.cc(),i.ec(8,"button",W),i.kc("tapped",function(n){i.Ec(e);const c=t.$implicit;return i.pc(2).confirmRemoveCondition(c)}),i.Yb(9,"app-icon",D),i.cc(),i.cc()}if(2&e){const e=t.$implicit,n=i.pc(2);i.Ic(3),i.Xc(" ",i.rc(4,6,e.left)," ",e.operator," ",i.rc(5,8,e.right)," "),i.Ic(6),i.vc("disabled",!n.template_system),i.Ic(7),i.vc("icon",H),i.Ic(9),i.vc("icon",U)}}function K(e,t){if(1&e){const e=i.fc();i.ec(0,"div",q),i.Yb(1,"div",z),i.ec(2,"div",G),i.Tc(3),i.cc(),i.ec(4,"button",$),i.kc("tapped",function(n){i.Ec(e);const c=t.$implicit;return i.pc(2).editCondition(c)}),i.Yb(5,"app-icon",D),i.cc(),i.ec(6,"button",W),i.kc("tapped",function(n){i.Ec(e);const c=t.$implicit;return i.pc(2).confirmRemoveCondition(c)}),i.Yb(7,"app-icon",D),i.cc(),i.cc()}if(2&e){const e=t.$implicit,n=i.pc(2);i.Ic(3),i.Wc(" ","at"===e.type?"At time":"CRON"," ","at"===e.type?e.time:e.cron," "),i.Ic(4),i.vc("disabled",!n.template_system),i.Ic(5),i.vc("icon",H),i.Ic(7),i.vc("icon",U)}}function Z(e,t){if(1&e&&(i.ec(0,"div",j),i.ec(1,"div",B),i.Tc(2,"Variable Comparison Condtions"),i.cc(),i.ec(3,"div",J),i.Rc(4,Q,10,10,"div",L),i.cc(),i.ec(5,"div",B),i.Tc(6,"Time Dependent Conditions"),i.cc(),i.ec(7,"div",V),i.Rc(8,K,8,5,"div",L),i.cc(),i.cc()),2&e){const e=i.pc();i.Ic(4),i.vc("ngForOf",e.comparisons)("ngForTrackBy",e.i),i.Ic(8),i.vc("ngForOf",e.time_dependents)("ngForTrackBy",e.i)}}const ee=["cdkDropList","",1,"group","functions",3,"cdkDropListDropped"],te=["class","item","cdkDrag","",4,"ngFor","ngForOf","ngForTrackBy"],ne=["cdkDropList","",1,"group","emails",3,"cdkDropListDropped"],ie=["cdkDrag","",1,"item"],ce=["cdkDragHandle","",1,"handle"],oe=["class","placeholder",4,"cdkDragPlaceholder"],se=[1,"placeholder"];function re(e,t){1&e&&i.Yb(0,"div",se)}const ae={class:"backoffice-select-arrows"};function de(e,t){if(1&e){const e=i.fc();i.ec(0,"div",ie),i.ec(1,"div",ce),i.Yb(2,"app-icon",D),i.cc(),i.ec(3,"div",G),i.Tc(4),i.qc(5,"json"),i.cc(),i.ec(6,"button",$),i.kc("tapped",function(n){i.Ec(e);const c=t.$implicit;return i.pc(2).editAction(c)}),i.Yb(7,"app-icon",D),i.cc(),i.ec(8,"button",W),i.kc("tapped",function(n){i.Ec(e);const c=t.$implicit;return i.pc(2).confirmRemoveAction(c)}),i.Yb(9,"app-icon",D),i.cc(),i.Rc(10,re,1,0,"div",oe),i.cc()}if(2&e){const e=t.$implicit,n=i.pc(2);i.Ic(2),i.vc("icon",ae),i.Ic(4),i.Xc(" ",e.mod,", ",e.method,"(",i.rc(5,7,e.args),") "),i.Ic(6),i.vc("disabled",!n.template_system),i.Ic(7),i.vc("icon",H),i.Ic(9),i.vc("icon",U)}}const ge=[3,"matTooltip"];function me(e,t){1&e&&i.Yb(0,"div",se)}function le(e,t){if(1&e){const e=i.fc();i.ec(0,"div",ie),i.ec(1,"div",ce),i.Yb(2,"app-icon",D),i.cc(),i.ec(3,"div",G),i.ec(4,"span",ge),i.qc(5,"formatList"),i.Tc(6),i.cc(),i.Tc(7),i.cc(),i.ec(8,"button",$),i.kc("tapped",function(n){i.Ec(e);const c=t.$implicit;return i.pc(2).editAction(c)}),i.Yb(9,"app-icon",D),i.cc(),i.ec(10,"button",W),i.kc("tapped",function(n){i.Ec(e);const c=t.$implicit;return i.pc(2).confirmRemoveAction(c)}),i.Yb(11,"app-icon",D),i.cc(),i.Rc(12,me,1,0,"div",oe),i.cc()}if(2&e){const e=t.$implicit,n=i.pc(2);i.Ic(2),i.vc("icon",ae),i.Ic(4),i.vc("matTooltip",i.rc(5,8,e.emails)),i.Ic(6),i.Wc("",e.emails.length," Address",1===e.emails.length?"":"es",""),i.Ic(7),i.Vc(" | Body Length: ",e.content.length," "),i.Ic(8),i.vc("disabled",!n.template_system),i.Ic(9),i.vc("icon",H),i.Ic(11),i.vc("icon",U)}}function pe(e,t){if(1&e){const e=i.fc();i.ec(0,"div",j),i.ec(1,"div",B),i.Tc(2,"Function Call Actions"),i.cc(),i.ec(3,"div",ee),i.kc("cdkDropListDropped",function(t){return i.Ec(e),i.pc().confirmReorder("function",t)}),i.Rc(4,de,11,9,"div",te),i.cc(),i.ec(5,"div",B),i.Tc(6,"Email Actions"),i.cc(),i.ec(7,"div",ne),i.kc("cdkDropListDropped",function(t){return i.Ec(e),i.pc().confirmReorder("mailer",t)}),i.Rc(8,le,13,10,"div",te),i.cc(),i.cc()}if(2&e){const e=i.pc();i.Ic(4),i.vc("ngForOf",e.functions)("ngForTrackBy",e.i),i.Ic(8),i.vc("ngForOf",e.mailers)("ngForTrackBy",e.i)}}const he=[1,"info-block"];function fe(e,t){1&e&&(i.ec(0,"div",he),i.ec(1,"div",F),i.Tc(2,"No condtions for trigger"),i.cc(),i.cc())}function ue(e,t){1&e&&(i.ec(0,"div",he),i.ec(1,"div",F),i.Tc(2,"No actions for trigger"),i.cc(),i.cc())}const be={class:"backoffice-plus"},ve=(()=>{class e extends y.a{constructor(e,t){super(),this._service=e,this._dialog=t,this.comparisons=[],this.time_dependents=[],this.functions=[],this.mailers=[]}get system_service(){return this._service.Systems}ngOnChanges(e){e.item&&(this.item&&this.item.conditions&&(this.comparisons=this.item.conditions.comparisons||[],this.time_dependents=this.item.conditions.time_dependents||[],this.functions=this.item.actions.functions||[],this.mailers=this.item.actions.mailers||[]),this.confirm_ref&&(this.confirm_ref.close(),this.confirm_ref=null,this.unsub("delete_confirm")))}addCondition(){this._dialog.open(O.a,{width:"auto",height:"auto",data:{trigger:this.item,system:this.template_system}})}editCondition(e){this._dialog.open(O.a,{width:"auto",height:"auto",data:{trigger:this.item,condition:JSON.parse(JSON.stringify(e)),system:this.template_system}})}addAction(){this._dialog.open(C.a,{data:{trigger:this.item,system:this.template_system}})}editAction(e){this._dialog.open(C.a,{data:{trigger:this.item,action:e,system:this.template_system}})}confirmRemoveCondition(e){this.confirm_ref=this._dialog.open(h.b,Object.assign({},h.a,{data:{title:"Remove trigger condition",content:"<p>Are you sure you want remove this trigger condition?</p><p>All systems using this trigger will be updated <strong>immediately</strong>.</p>",icon:{type:"icon",class:"backoffice-trash"}}})),this.subscription("delete_confirm",this.confirm_ref.componentInstance.event.subscribe(t=>{"done"===t.reason&&(this.confirm_ref.componentInstance.loading="Removing trigger condition...",this.removeCondition(e))}))}removeCondition(e){const t={comparisons:[...this.comparisons],time_dependents:[...this.time_dependents]};if(e.type){const n=this.time_dependents.findIndex(t=>JSON.stringify(t)===JSON.stringify(e));t.time_dependents.splice(n,1)}else{const n=this.comparisons.findIndex(t=>JSON.stringify(t)===JSON.stringify(e));t.comparisons.splice(n,1)}this.item.storePendingChange("conditions",t),this.item.save().then(()=>this._service.notifySuccess("Successfully removed trigger condition."),e=>this._service.notifyError(`Error removing trigger condition. Error: ${e.message||e}`))}confirmRemoveAction(e){this.confirm_ref=this._dialog.open(h.b,Object.assign({},h.a,{data:{title:"Remove trigger action",content:"<p>Are you sure you want remove this trigger action?</p><p>All systems using this trigger will be updated <strong>immediately</strong>.</p>",icon:{type:"icon",class:"backoffice-trash"}}})),this.subscription("delete_confirm",this.confirm_ref.componentInstance.event.subscribe(t=>{"done"===t.reason&&(this.confirm_ref.componentInstance.loading="Removing trigger action...",this.removeAction(e))}))}removeAction(e){const t={functions:[...this.item.actions.functions],mailers:[...this.item.actions.mailers]};if(e.emails){const n=this.mailers.findIndex(t=>JSON.stringify(t)===JSON.stringify(e));t.mailers.splice(n,1)}else{const n=this.functions.findIndex(t=>JSON.stringify(t)===JSON.stringify(e));t.functions.splice(n,1)}this.item.storePendingChange("actions",t),this.item.save().then(()=>this._service.notifySuccess("Successfully removed trigger action."),e=>this._service.notifyError(`Error removing trigger action. Error: ${e.message||e}`))}confirmReorder(e,t){this.confirm_ref=this._dialog.open(h.b,Object.assign({},h.a,{data:{title:`Reoreder trigger ${e} action`,content:"<p>Are you sure you want remove this trigger condition?</p><p>All systems using this trigger will be updated <strong>immediately</strong>.</p>",icon:{type:"icon",class:"backoffice-trash"}}})),this.subscription("delete_confirm",this.confirm_ref.componentInstance.event.subscribe(n=>{"done"===n.reason&&(this.confirm_ref.componentInstance.loading=`Reordering trigger ${e} action...`,this.reorderAction(e,t))}))}reorderAction(e,t){const n=[..."function"===e?this.functions:this.mailers];Object(r.f)(n,t.previousIndex,t.currentIndex),this.item.storePendingChange("actions",{functions:"function"===e?n:this.functions,mailers:"function"===e?this.mailers:n}),this.item.save().then(()=>this._service.notifySuccess(`Successfully re-ordered trigger ${e} action.`),t=>this._service.notifyError(`Error re-ordered trigger ${e} action. Error: ${t.message||t}`))}}return e.ngComponentDef=i.Rb({type:e,selectors:[["trigger-about"]],factory:function(t){return new(t||e)(i.Xb(m.a),i.Xb(u.b))},inputs:{item:"item"},features:[i.Fb,i.Gb()],consts:27,vars:10,template:function(e,t){if(1&e&&(i.ec(0,"div",x),i.ec(1,"div",T),i.ec(2,"section"),i.ec(3,"div",R),i.ec(4,"label",E),i.Tc(5,"Template System: "),i.cc(),i.ec(6,"item-search-field",A),i.kc("ngModelChange",function(e){return t.template_system=e}),i.cc(),i.cc(),i.cc(),i.ec(7,"header"),i.ec(8,"div",S),i.ec(9,"button",$),i.kc("tapped",function(e){return t.addCondition()}),i.Yb(10,"app-icon",D),i.cc(),i.cc(),i.ec(11,"div",F),i.Tc(12,"Conditions"),i.cc(),i.cc(),i.ec(13,"section"),i.Rc(14,Z,9,4,"div",Y),i.cc(),i.ec(15,"header"),i.ec(16,"div",S),i.ec(17,"button",$),i.kc("tapped",function(e){return t.addAction()}),i.Yb(18,"app-icon",D),i.cc(),i.cc(),i.ec(19,"div",F),i.Tc(20,"Actions"),i.cc(),i.cc(),i.ec(21,"section"),i.Rc(22,pe,9,4,"div",Y),i.cc(),i.cc(),i.cc(),i.Rc(23,fe,3,0,"ng-template",null,N,i.Sc),i.Rc(25,ue,3,0,"ng-template",null,X,i.Sc)),2&e){const e=i.Bc(24),n=i.Bc(26);i.Ic(6),i.vc("service",t.system_service)("ngModel",t.template_system),i.Ic(9),i.vc("disabled",!t.template_system),i.Ic(10),i.vc("icon",be),i.Ic(14),i.vc("ngIf",t.comparisons.length||t.time_dependents.length)("ngIfElse",e),i.Ic(17),i.vc("disabled",!t.template_system),i.Ic(18),i.vc("icon",be),i.Ic(22),i.vc("ngIf",t.functions.length||t.mailers.length)("ngIfElse",n)}},directives:[w.a,I.a,o.k,o.n,P.b,v.b,M.a,c.n,c.m,r.d,r.a,r.b,r.c],pipes:[c.g,k.a],styles:['.container[_ngcontent-%COMP%]{padding:1em}header[_ngcontent-%COMP%]{display:flex;align-items:center;font-weight:700;font-size:1.1em}section[_ngcontent-%COMP%]{padding:.5em .25em}.no-item[_ngcontent-%COMP%]{font-size:.75em}.group[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;width:100%}.item[_ngcontent-%COMP%]{display:flex;align-items:center;border-radius:4px;margin:2px 0;width:100%}.item[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:2.5rem;width:2.5rem}.item[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.item[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{flex:1;min-width:50%;font-family:"Fira Code",monospace;white-space:nowrap;font-size:.6em;padding:0 .5rem;overflow:hidden;text-overflow:ellipsis}.item[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-family:"Fira Code",monospace}.item[_ngcontent-%COMP%]:nth-child(2n){background-color:#f0f0f0}.item[_ngcontent-%COMP%]:hover{background-color:#ccc}button[_ngcontent-%COMP%]{margin:.25em}header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 .5em 0 0;border:1px solid rgba(0,0,0,.85)}header[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{border-color:#ccc}.header[_ngcontent-%COMP%]{padding:1em;font-size:1em;font-weight:500}.cdk-drag-preview[_ngcontent-%COMP%]{background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 0 rgba(0,0,0,.12)}.cdk-drag-preview[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:none}.placeholder[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.1);border:4px dashed rgba(0,0,0,.6);height:3em;width:100%;border-radius:4px}']}),e})();var _e=n("oIn+");const ye=[1,"container"],Ce=[1,"settings"],Oe=[4,"ngIf","ngIfElse"],we=["empty_state",""],Ie=[1,"small"],Pe=[1,"flex"],Me=[4,"ngFor","ngForOf"],ke=[1,"state"],xe=[3,"routerLink",4,"ngIf"],Te=["mat-icon-button","",3,"tapped"],Re=[3,"icon"],Ee=[3,"routerLink"],Ae=[1,"id"],Se=function(e){return["/systems",e]};function $e(e,t){if(1&e&&(i.ec(0,"a",Ee),i.Tc(1),i.ec(2,"span",Ae),i.Tc(3),i.cc(),i.Tc(4,") "),i.cc()),2&e){const e=i.pc().$implicit;i.vc("routerLink",i.wc(3,Se,e.system_id)),i.Ic(1),i.Vc(" ",e.system_name," ("),i.Ic(3),i.Uc(e.system_id)}}const De={class:"backoffice-trash"};function Fe(e,t){if(1&e){const e=i.fc();i.ec(0,"tr"),i.ec(1,"td",Ie),i.ec(2,"div",ke),i.Pc(),i.cc(),i.cc(),i.ec(3,"td",Pe),i.Rc(4,$e,5,5,"a",xe),i.cc(),i.ec(5,"td"),i.Tc(6),i.qc(7,"dateFrom"),i.cc(),i.ec(8,"td",Ie),i.ec(9,"button",Te),i.kc("tapped",function(n){i.Ec(e);const c=t.$implicit;return i.pc(2).delete(c)}),i.Yb(10,"app-icon",Re),i.cc(),i.cc(),i.cc()}if(2&e){const e=t.$implicit;i.Ic(2),i.Mb("active",e.enabled),i.Qc(),i.Ic(4),i.vc("ngIf",e.system_id),i.Ic(6),i.Uc(i.rc(7,4,1e3*(e.created_at-0))),i.Ic(10),i.vc("icon",De)}}function Ye(e,t){if(1&e&&(i.ec(0,"table"),i.ec(1,"thead"),i.Yb(2,"td",Ie),i.ec(3,"td",Pe),i.Tc(4,"Name"),i.cc(),i.ec(5,"td",Pe),i.Tc(6,"Added"),i.cc(),i.Yb(7,"td",Ie),i.cc(),i.ec(8,"tbody"),i.Rc(9,Fe,11,6,"tr",Me),i.cc(),i.cc()),2&e){const e=i.pc();i.Ic(9),i.vc("ngForOf",e.system_trigger_list)}}const Ne=[1,"info-block"],Xe=[1,"text"];function je(e,t){1&e&&(i.ec(0,"div",Ne),i.ec(1,"div",Xe),i.Tc(2,"No systems with trigger"),i.cc(),i.cc())}const Be=(()=>{class e extends y.a{constructor(e,t,n){super(),this._service=e,this._dialog=t,this._composer=n,this.system_trigger_list=[],this.connected={}}ngOnChanges(e){e.item&&this.loadSystemTriggers()}loadSystemTriggers(e=0){this._service.SystemTriggers.query({trigger_id:this.item.id,offset:e}).then(e=>this.system_trigger_list=e||[],()=>null)}delete(e){if(e){const t=this._dialog.open(h.b,Object.assign({},h.a,{data:{title:"Remove trigger",content:`<p>Are you sure you want remove this trigger?</p><p>Deleting this trigger will <strong>immediately</strong> remove from the system "${e.system_name||""}"</p>`,icon:{type:"icon",class:"backoffice-trash"}}}));this.subscription("delete_confirm",t.componentInstance.event.subscribe(n=>d.b(this,void 0,void 0,function*(){"done"===n.reason&&(t.componentInstance.loading="Removing trigger...",yield this.deleteTrigger(e).catch(e=>{throw t.componentInstance.loading=null,this._service.notifyError(`Error removing trigger. Error: ${e.message||e}`),e}),this.loadSystemTriggers(),t.close(),this.unsub("delete_confirm"))})))}}deleteTrigger(e){return new Promise((t,n)=>{this._composer.http.delete(`${this._composer.auth.api_endpoint}/systems/${e.system_id}/triggers/${e.id}`).subscribe(e=>null,e=>n(e),()=>t())})}}return e.ngComponentDef=i.Rb({type:e,selectors:[["trigger-systems"]],factory:function(t){return new(t||e)(i.Xb(m.a),i.Xb(u.b),i.Xb(a.c))},inputs:{item:"item"},features:[i.Fb,i.Gb()],consts:5,vars:2,template:function(e,t){if(1&e&&(i.ec(0,"div",ye),i.ec(1,"div",Ce),i.Rc(2,Ye,10,1,"table",Oe),i.cc(),i.cc(),i.Rc(3,je,3,0,"ng-template",null,we,i.Sc)),2&e){const e=i.Bc(4);i.Ic(2),i.vc("ngIf",t.system_trigger_list.length>0)("ngIfElse",e)}},directives:[c.n,c.m,P.b,v.b,M.a,s.f],pipes:[_e.a],styles:[".container[_ngcontent-%COMP%]{padding:1em}.list[_ngcontent-%COMP%]{margin-top:.5em}tbody[_ngcontent-%COMP%]{font-size:.9em}tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-overflow:ellipsis;white-space:nowrap}div[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]{width:2em}div[_ngcontent-%COMP%]   .duo[_ngcontent-%COMP%]{width:4em}div[_ngcontent-%COMP%]   .duo[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{display:inline-flex}.action[_ngcontent-%COMP%]{height:1.5em;width:1.5em;min-width:1.5em;border-radius:.65em;display:flex;align-items:center;justify-content:center;font-size:1.3em}.action[_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.1)}.state[_ngcontent-%COMP%]{height:1.5em;width:1.5em;margin:.25em;background-color:#000;border-radius:.8em;transition:margin 250ms,height 250ms,width 250ms,background-color .3s}.state.active[_ngcontent-%COMP%]{background-color:#4caf50;height:.75em;width:.75em;margin:.625em}.select[_ngcontent-%COMP%]{display:flex;align-items:center}.select[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{flex:1}"]}),e})(),Je=[1,"container"],Le=[1,"sidebar"],Ve=["heading","Triggers",3,"module","close","searchChange","event"],qe=[3,"touchrelease"],ze=["name","trigger",3,"item","loading","active","tabs","event"],Ge=["about",""],We=["systems",""],He=[3,"item"];function Ue(e,t){if(1&e&&i.Yb(0,"trigger-about",He),2&e){const e=i.pc();i.vc("item",e.item)}}function Qe(e,t){if(1&e&&i.Yb(0,"trigger-systems",He),2&e){const e=i.pc();i.vc("item",e.item)}}const Ke={class:"backoffice-info-with-circle"},Ze=function(e){return{id:"about",name:"About",template:e,icon:Ke}},et={class:"backoffice-documents"},tt=function(e,t){return{id:"systems",name:"Systems",template:e,count:t,icon:et}},nt=function(e,t){return[e,t]},it=(()=>{class e extends l.a{constructor(e,t,n,i){super(e,t,n),this._service=e,this._route=t,this._router=n,this._dialog=i,this.service=this._service.Triggers}loadValues(){const e={offset:0,limit:1,trigger_id:this.item.id};Object(p.b)(e),this._service.SystemTriggers.query(e).then(()=>this.system_count=this._service.SystemTriggers.last_total)}new(){this._dialog.open(f.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:new g.o(this._service.Triggers,{}),service:this._service.Triggers}})}edit(){this.item&&this._dialog.open(f.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:this.item,service:this._service.Triggers}})}delete(){if(this.item){const e=this._dialog.open(h.b,Object.assign({},h.a,{data:{title:"Delete trigger",content:"<p>Are you sure you want delete this trigger?</p><p>Deleting this trigger will <strong>immediately</strong> remove it from all associated systems and zones</p>",icon:{type:"icon",class:"backoffice-trash"}}}));this.subscription("delete_confirm",e.componentInstance.event.subscribe(t=>d.b(this,void 0,void 0,function*(){"done"===t.reason&&(e.componentInstance.loading="Deleting trigger...",yield this.item.delete().catch(t=>{throw e.componentInstance.loading=null,this._service.notifyError(`Error deleting trigger. Error: ${t.message||t}`),t}),this._router.navigate(["/triggers"]),e.close(),this.unsub("delete_confirm"))})))}}}return e.ngComponentDef=i.Rb({type:e,selectors:[["app-triggers"]],factory:function(t){return new(t||e)(i.Xb(m.a),i.Xb(s.a),i.Xb(s.c),i.Xb(u.b))},features:[i.Fb],consts:9,vars:15,template:function(e,t){if(1&e&&(i.ec(0,"div",Je),i.Pc(),i.ec(1,"div",Le),i.ec(2,"sidebar",Ve),i.kc("searchChange",function(e){return t.search(e)}),i.kc("event",function(e){return t.sidebarEvent(e)}),i.cc(),i.cc(),i.ec(3,"main",qe),i.kc("touchrelease",function(e){return t.show_sidebar=!1}),i.ec(4,"item-display",ze),i.kc("event",function(e){return t.itemEvent(e)}),i.Rc(5,Ue,1,1,"ng-template",null,Ge,i.Sc),i.Rc(7,Qe,1,1,"ng-template",null,We,i.Sc),i.cc(),i.cc(),i.cc()),2&e){const e=i.Bc(6),n=i.Bc(8);i.Mb("show",t.show_sidebar),i.Qc(),i.Ic(2),i.vc("module",t.module)("close",t.show_sidebar),i.Ic(4),i.vc("item",t.item)("loading",t.loading_item)("active",t.tab)("tabs",i.xc(12,nt,i.wc(7,Ze,e),i.xc(9,tt,n,t.system_count)))}},directives:[b.a,v.b,_.a,ve,Be],styles:[".container[_ngcontent-%COMP%]{display:flex;align-items:center;height:100%;width:100%}.sidebar[_ngcontent-%COMP%]{height:100%;width:20em}@media only screen and (orientation:portrait) and (max-width:450px){.container[_ngcontent-%COMP%]{flex-direction:column}.container.show[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{height:100%}.container.show[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{height:0%}.sidebar[_ngcontent-%COMP%]{height:3em;min-height:3em;width:100%;transition:height .3s}main[_ngcontent-%COMP%]{transition:height .3s;width:100%}}@media only screen and (orientation:landscape) and (max-width:800px){.container[_ngcontent-%COMP%]{flex-direction:column}.container.show[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{height:100%}.container.show[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{height:0%}.sidebar[_ngcontent-%COMP%]{height:3em;min-height:3em;width:100%;transition:height .3s}main[_ngcontent-%COMP%]{transition:height .3s;width:100%}}main[_ngcontent-%COMP%]{position:relative;height:100%;overflow:hidden;flex:1;background-color:#f0f0f0}"]}),e})(),ct=[{path:"",component:it,children:[]},{path:":id",component:it,children:[]},{path:"**",redirectTo:""}];var ot=n("PCNd");n.d(t,"AppTriggersModule",function(){return st});const st=(()=>{class e{}return e.ngModuleDef=i.Vb({type:e}),e.ngInjectorDef=i.Ub({factory:function(t){return new(t||e)},imports:[[c.c,o.g,a.b,s.g.forChild(ct),ot.a,r.e]]}),e})();s.g.forChild(ct)}}]);