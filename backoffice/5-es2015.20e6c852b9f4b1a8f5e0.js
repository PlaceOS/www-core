(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{aCzL:function(t,e,n){"use strict";n.r(e);var c=n("fXoL"),i=n("ofXK"),o=n("3Pt+"),s=n("tyNb"),a=n("CcG0"),r=n("UN3I"),l=n("OaWH"),d=n("C/ya"),m=n("D/9M"),h=n("g+Po"),u=n("LcAk"),p=n("BAfr"),g=n("m6yr"),f=n("47y3"),b=n("5f3J"),_=n("Xlwt"),v=n("0njA");const w=[1,"container"],C=[1,"select"],O=["mat-button","",3,"tapped"],y=["class","list",4,"ngIf"],M=["class","info-block",4,"ngIf"],P=[1,"list"],I=[1,"name"],k=[1,"flex"],x=[1,"scope"],A=[1,"duo"],T=[4,"ngFor","ngForOf"],R=["mat-icon-button","",3,"tapped"],D=[3,"icon"],U={class:"backoffice-edit"},F={class:"backoffice-trash"};function E(t,e){if(1&t){const t=c.fc();c.ec(0,"tr"),c.ec(1,"td",I),c.Tc(2),c.cc(),c.ec(3,"td",k),c.Tc(4),c.cc(),c.ec(5,"td",x),c.Tc(6),c.cc(),c.ec(7,"td",A),c.ec(8,"button",R),c.kc("tapped",function(n){c.Ec(t);const i=e.$implicit;return c.pc(2).editApplication(i)}),c.Yb(9,"app-icon",D),c.cc(),c.ec(10,"button",R),c.kc("tapped",function(n){c.Ec(t);const i=e.$implicit;return c.pc(2).deleteApplication(i)}),c.Yb(11,"app-icon",D),c.cc(),c.cc(),c.cc()}if(2&t){const t=e.$implicit;c.Ic(2),c.Uc(t.name),c.Ic(4),c.Uc(t.redirect),c.Ic(6),c.Uc(t.scope),c.Ic(9),c.vc("icon",U),c.Ic(11),c.vc("icon",F)}}function S(t,e){if(1&t&&(c.ec(0,"div",P),c.ec(1,"table"),c.ec(2,"thead"),c.ec(3,"td",I),c.Tc(4,"Name"),c.cc(),c.ec(5,"td",k),c.Tc(6,"Redirect"),c.cc(),c.ec(7,"td",x),c.Tc(8,"Scope"),c.cc(),c.Yb(9,"td",A),c.cc(),c.ec(10,"tbody"),c.Rc(11,E,12,5,"tr",T),c.cc(),c.cc(),c.cc()),2&t){const t=c.pc();c.Ic(11),c.vc("ngForOf",t.application_list)}}const X=[1,"info-block"],$=[1,"text"];function j(t,e){1&t&&(c.ec(0,"div",X),c.ec(1,"div",$),c.Tc(2,"No applications found"),c.cc(),c.cc())}const N=(()=>{class t extends b.a{constructor(t,e){super(),this._service=t,this._dialog=e}ngOnChanges(t){t.item&&this.loadApplications()}loadApplications(t=0){this._service.Applications.query({owner:this.item.id,offset:t}).then(e=>{t||(this.application_list=[]);for(const t of e||[]){let e=!1;for(const n of this.application_list)if(n.id===t.id){e=!0;break}e||this.application_list.push(t)}},()=>null)}newApplication(){this._dialog.open(m.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:new r.c(this._service.Applications,{}),service:this._service.Applications}})}editApplication(t){this.item&&this._dialog.open(m.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:t,service:this._service.Applications}})}deleteApplication(t){if(t){const e=this._dialog.open(h.b,Object.assign({},h.a,{data:{title:"Delete application",content:`<p>Are you sure you want delete the application ${t.name}?</p><p>Configuration will be <strong>immediately</strong> updated</p>`,icon:{type:"icon",class:"backoffice-trash"}}}));this.subscription("delete_confirm",e.componentInstance.event.subscribe(n=>{"done"===n.reason&&(e.componentInstance.loading="Deleting application...",t.delete().then(()=>{this._service.notifySuccess(`Successfully deleted application "${t.name}".`),this.loadApplications(),e.close(),this.unsub("delete_confirm")},t=>{e.componentInstance.loading=null,this._service.notifyError(`Error deleting application. Error: ${t}`)}))}))}}}return t.ngComponentDef=c.Rb({type:t,selectors:[["domain-applications"]],factory:function(e){return new(e||t)(c.Xb(l.a),c.Xb(u.b))},inputs:{item:"item"},features:[c.Fb,c.Gb()],consts:7,vars:2,template:function(t,e){1&t&&(c.ec(0,"div",w),c.ec(1,"section",C),c.ec(2,"button",O),c.kc("tapped",function(t){return e.newApplication()}),c.Tc(3,"Add new"),c.cc(),c.cc(),c.ec(4,"section"),c.Rc(5,S,12,1,"div",y),c.Rc(6,j,3,0,"div",M),c.cc(),c.cc()),2&t&&(c.Ic(5),c.vc("ngIf",e.application_list&&e.application_list.length>0),c.Ic(6),c.vc("ngIf",!e.application_list||e.application_list.length<=0))},directives:[_.b,g.b,i.n,i.m,v.a],styles:[".container[_ngcontent-%COMP%]{padding:1em}.options[_ngcontent-%COMP%]{display:flex;font-size:1.2em;max-width:5em;margin:0}.state[_ngcontent-%COMP%]{height:1.5em;width:1.5em;margin:.25em;background-color:#000;border-radius:.8em;transition:margin 250ms,height 250ms,width 250ms,background-color .3s}.state.active[_ngcontent-%COMP%]{background-color:#4caf50;height:.75em;width:.75em;margin:.625em}.duo[_ngcontent-%COMP%]{width:6em}.table-row[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%], .table-row[_ngcontent-%COMP%]   .scope[_ngcontent-%COMP%]{width:8em;min-width:8em}.select[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}section[_ngcontent-%COMP%]{padding:.5em .25em}"]}),t})(),Y=[1,"container"],z=[1,"select"],q=["mat-button",""],H=["class","list",4,"ngIf"],W=["class","info-block",4,"ngIf"],B=[1,"list"],G=[1,"name"],L=[1,"flex"],J=[1,"duo"],V=[4,"ngFor","ngForOf"],K=[1,"action"],Q=[1,"backoffice-edit"],Z=[1,"backoffice-trash"];function tt(t,e){if(1&t&&(c.ec(0,"tr"),c.ec(1,"td",G),c.Tc(2),c.cc(),c.ec(3,"td",L),c.Tc(4),c.cc(),c.ec(5,"td",J),c.ec(6,"div",K),c.Yb(7,"i",Q),c.cc(),c.ec(8,"div",K),c.Yb(9,"i",Z),c.cc(),c.cc(),c.cc()),2&t){const t=e.$implicit;c.Ic(2),c.Uc(t.name),c.Ic(4),c.Uc(t.redirect)}}function et(t,e){if(1&t&&(c.ec(0,"div",B),c.ec(1,"table"),c.ec(2,"thead"),c.ec(3,"td",G),c.Tc(4,"Name"),c.cc(),c.ec(5,"td",L),c.Tc(6,"URL"),c.cc(),c.Yb(7,"td",J),c.cc(),c.ec(8,"tbody"),c.Rc(9,tt,10,2,"tr",V),c.cc(),c.cc(),c.cc()),2&t){const t=c.pc();c.Ic(9),c.vc("ngForOf",t.model.list)}}const nt=[1,"info-block"],ct=[1,"text"];function it(t,e){1&t&&(c.ec(0,"div",nt),c.ec(1,"div",ct),c.Tc(2,"No authentication sources found"),c.cc(),c.cc())}const ot=(()=>{class t extends b.a{constructor(t){super(),this.service=t,this.model={}}ngOnChanges(t){t.item&&this.load()}load(t=0){this.service.AuthSources.query({authority_id:this.item.id,offset:t}).then(e=>{t||(this.model.list=[]);for(const t of e||[]){let e=!1;for(const n of this.model.list)if(n.id===t.id){e=!0;break}e||this.model.list.push(t)}},()=>null)}}return t.ngComponentDef=c.Rb({type:t,selectors:[["domain-authentication"]],factory:function(e){return new(e||t)(c.Xb(l.a))},inputs:{item:"item"},features:[c.Fb,c.Gb()],consts:7,vars:2,template:function(t,e){1&t&&(c.ec(0,"div",Y),c.ec(1,"section",z),c.ec(2,"button",q),c.Tc(3,"Add new"),c.cc(),c.cc(),c.ec(4,"section"),c.Rc(5,et,10,1,"div",H),c.Rc(6,it,3,0,"div",W),c.cc(),c.cc()),2&t&&(c.Ic(5),c.vc("ngIf",e.model.list&&e.model.list.length>0),c.Ic(6),c.vc("ngIf",!e.model.list||e.model.list.length<=0))},directives:[_.b,i.n,i.m],styles:[".container[_ngcontent-%COMP%]{padding:1em}.options[_ngcontent-%COMP%]{display:flex;font-size:1.2em;max-width:5em;margin:0}.action[_ngcontent-%COMP%]{height:1.5em;width:1.5em;min-width:1.5em;border-radius:.65em;display:flex;align-items:center;justify-content:center;font-size:1.3em}.action[_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.1)}.table-row[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{width:8em;min-width:8em}.state[_ngcontent-%COMP%]{height:1.5em;width:1.5em;margin:.25em;background-color:#000;border-radius:.8em;transition:margin 250ms,height 250ms,width 250ms,background-color .3s}.state.active[_ngcontent-%COMP%]{background-color:#4caf50;height:.75em;width:.75em;margin:.625em}.select[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}section[_ngcontent-%COMP%]{padding:.5em .25em}"]}),t})(),st=[1,"container"],at=["class","list",4,"ngIf"],rt=["class","info-block",4,"ngIf"],lt=[1,"list"],dt=[1,"name"],mt=[1,"flex"],ht=[1,"role"],ut=[4,"ngFor","ngForOf"];function pt(t,e){if(1&t&&(c.ec(0,"tr"),c.ec(1,"td",dt),c.Tc(2),c.cc(),c.ec(3,"td",mt),c.Tc(4),c.cc(),c.ec(5,"td",ht),c.Tc(6),c.cc(),c.cc()),2&t){const t=e.$implicit;c.Ic(2),c.Uc(t.name),c.Ic(4),c.Uc(t.email),c.Ic(6),c.Uc(t.role)}}function gt(t,e){if(1&t&&(c.ec(0,"div",lt),c.ec(1,"table"),c.ec(2,"thead"),c.ec(3,"td",dt),c.Tc(4,"Name"),c.cc(),c.ec(5,"td",mt),c.Tc(6,"Email"),c.cc(),c.ec(7,"td",ht),c.Tc(8,"Role"),c.cc(),c.cc(),c.ec(9,"tbody"),c.Rc(10,pt,7,3,"tr",ut),c.cc(),c.cc(),c.cc()),2&t){const t=c.pc();c.Ic(10),c.vc("ngForOf",t.model.list)}}const ft=[1,"info-block"],bt=[1,"text"];function _t(t,e){1&t&&(c.ec(0,"div",ft),c.ec(1,"div",bt),c.Tc(2,"No users found"),c.cc(),c.cc())}const vt=(()=>{class t extends b.a{constructor(t){super(),this.service=t,this.model={}}ngOnInit(){this.load()}ngOnChanges(t){t.item&&this.load()}load(t=0){this.service.Users.query({authority_id:this.item.id,offset:t}).then(e=>{t||(this.model.list=[]);for(const t of e||[]){let e=!1;for(const n of this.model.list)if(n.id===t.id){e=!0;break}e||this.model.list.push(t)}},()=>null)}}return t.ngComponentDef=c.Rb({type:t,selectors:[["domain-users"]],factory:function(e){return new(e||t)(c.Xb(l.a))},inputs:{item:"item"},features:[c.Fb,c.Gb()],consts:4,vars:2,template:function(t,e){1&t&&(c.ec(0,"div",st),c.ec(1,"section"),c.Rc(2,gt,11,1,"div",at),c.Rc(3,_t,3,0,"div",rt),c.cc(),c.cc()),2&t&&(c.Ic(2),c.vc("ngIf",e.model.list&&e.model.list.length>0),c.Ic(3),c.vc("ngIf",!e.model.list||e.model.list.length<=0))},directives:[i.n,i.m],styles:[".container[_ngcontent-%COMP%]{padding:1em}.options[_ngcontent-%COMP%]{display:flex;font-size:1.2em;max-width:5em;margin:0}.action[_ngcontent-%COMP%]{height:1.5em;width:1.5em;min-width:1.5em;border-radius:.65em;display:flex;align-items:center;justify-content:center;font-size:1.3em}.action[_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.1)}.table-row[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{width:12em;min-width:12em}.table-row[_ngcontent-%COMP%]   .role[_ngcontent-%COMP%]{width:8em;min-width:8em}.state[_ngcontent-%COMP%]{height:1.5em;width:1.5em;margin:.25em;background-color:#000;border-radius:.8em;transition:margin 250ms,height 250ms,width 250ms,background-color .3s}.state.active[_ngcontent-%COMP%]{background-color:#4caf50;height:.75em;width:.75em;margin:.625em}.select[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}section[_ngcontent-%COMP%]{padding:.5em .25em}"]}),t})(),wt=[1,"container"],Ct=[1,"sidebar"],Ot=["heading","Domains",3,"module","close","searchChange","event"],yt=[3,"touchrelease"],Mt=["name","zone",3,"item","active","tabs","event"],Pt=["apps",""],It=["auth",""],kt=["users",""],xt=[3,"item"];function At(t,e){if(1&t&&c.Yb(0,"domain-applications",xt),2&t){const t=c.pc();c.vc("item",t.item)}}function Tt(t,e){if(1&t&&c.Yb(0,"domain-authentication",xt),2&t){const t=c.pc();c.vc("item",t.item)}}function Rt(t,e){if(1&t&&c.Yb(0,"domain-users",xt),2&t){const t=c.pc();c.vc("item",t.item)}}const Dt={class:"backoffice-publish"},Ut=function(t,e){return{id:"applications",name:"Applications",count:t,template:e,icon:Dt}},Ft={class:"backoffice-lock-open"},Et=function(t,e){return{id:"authentication",name:"Authentication",count:t,template:e,icon:Ft}},St={class:"backoffice-users"},Xt=function(t,e){return{id:"users",name:"Users",count:t,template:e,icon:St}},$t=function(t,e,n){return[t,e,n]},jt=(()=>{class t extends d.a{constructor(t,e,n,c){super(t,e,n),this._service=t,this._route=e,this._router=n,this._dialog=c,this.service=this._service.Domains}loadValues(){let t={offset:0,limit:1,owner:this.item.id};this._service.Applications.query(t).then(()=>this.applications=this._service.Applications.last_total),this._service.AuthSources.query(t={offset:0,limit:1,authority_id:this.item.id}).then(()=>this.auth_sources=this._service.AuthSources.last_total),this._service.Users.query(t).then(()=>this.user_count=this._service.Users.last_total)}new(){this._dialog.open(m.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:new r.e(this._service.Domains,{}),service:this._service.Domains}})}edit(){this.item&&this._dialog.open(m.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:this.item,service:this._service.Domains}})}delete(){if(this.item){const t=this._dialog.open(h.b,Object.assign({},h.a,{data:{title:"Delete domain",content:"<p>Are you sure you want delete this domain?</p><p>The domain will be deleted <strong>immediately.</strong></p>",icon:{type:"icon",class:"backoffice-trash"}}}));this.subscription("delete_confirm",t.componentInstance.event.subscribe(e=>{"done"===e.reason&&(t.componentInstance.loading="Deleting domain...",this.item.delete().then(()=>{this._service.notifySuccess(`Successfully deleted domain "${this.item.name}".`),this._router.navigate(["/users"]),t.close(),this.unsub("delete_confirm")},e=>{t.componentInstance.loading=null,this._service.notifyError(`Error deleting domain. Error: ${e}`)}))}))}}}return t.ngComponentDef=c.Rb({type:t,selectors:[["app-domains"]],factory:function(e){return new(e||t)(c.Xb(l.a),c.Xb(s.a),c.Xb(s.c),c.Xb(u.b))},features:[c.Fb],consts:11,vars:19,template:function(t,e){if(1&t&&(c.ec(0,"div",wt),c.Pc(),c.ec(1,"div",Ct),c.ec(2,"sidebar",Ot),c.kc("searchChange",function(t){return e.search(t)}),c.kc("event",function(t){return e.sidebarEvent(t)}),c.cc(),c.cc(),c.ec(3,"main",yt),c.kc("touchrelease",function(t){return e.show_sidebar=!1}),c.ec(4,"item-display",Mt),c.kc("event",function(t){return e.itemEvent(t)}),c.Rc(5,At,1,1,"ng-template",null,Pt,c.Sc),c.Rc(7,Tt,1,1,"ng-template",null,It,c.Sc),c.Rc(9,Rt,1,1,"ng-template",null,kt,c.Sc),c.cc(),c.cc(),c.cc()),2&t){const t=c.Bc(6),n=c.Bc(8),i=c.Bc(10);c.Mb("show",e.show_sidebar),c.Qc(),c.Ic(2),c.vc("module",e.module)("close",e.show_sidebar),c.Ic(4),c.vc("item",e.item)("active",e.tab)("tabs",c.yc(15,$t,c.xc(6,Ut,e.applications||0,t),c.xc(9,Et,e.auth_sources||0,n),c.xc(12,Xt,e.user_count||0,i)))}},directives:[p.a,g.b,f.a,N,ot,vt],styles:[".container[_ngcontent-%COMP%]{display:flex;align-items:center;height:100%;width:100%}.sidebar[_ngcontent-%COMP%]{height:100%;width:20em}@media only screen and (orientation:portrait) and (max-width:450px){.container[_ngcontent-%COMP%]{flex-direction:column}.container.show[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{height:100%}.container.show[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{height:0%}.sidebar[_ngcontent-%COMP%]{height:3em;min-height:3em;width:100%;transition:height .3s}main[_ngcontent-%COMP%]{transition:height .3s;width:100%}}@media only screen and (orientation:landscape) and (max-width:800px){.container[_ngcontent-%COMP%]{flex-direction:column}.container.show[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{height:100%}.container.show[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{height:0%}.sidebar[_ngcontent-%COMP%]{height:3em;min-height:3em;width:100%;transition:height .3s}main[_ngcontent-%COMP%]{transition:height .3s;width:100%}}main[_ngcontent-%COMP%]{position:relative;height:100%;overflow:hidden;flex:1;background-color:#f0f0f0}"]}),t})(),Nt=[{path:"",component:jt,children:[]},{path:":id",component:jt,children:[]},{path:"**",redirectTo:""}];var Yt=n("PCNd");n.d(e,"AppDomainsModule",function(){return zt});const zt=(()=>{class t{}return t.ngModuleDef=c.Vb({type:t}),t.ngInjectorDef=c.Ub({factory:function(e){return new(e||t)},imports:[[i.c,o.g,a.b,s.g.forChild(Nt),Yt.a]]}),t})();s.g.forChild(Nt)}}]);