(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{wKJ7:function(e,t,n){"use strict";n.r(t);var i=n("TYT/"),c=n("Valr"),o=n("QJY3"),r=n("DUip"),s=n("jdDG"),a=n("pS6y"),d=n("mrSG"),g=n("UN3I"),m=n("OaWH"),l=n("C/ya"),p=n("0IXN"),f=n("g+Po"),u=n("D/9M"),h=n("QrbZ"),v=n("BAfr"),b=n("ZwpQ"),_=n("47y3"),y=n("5f3J"),C=n("xQV9"),O=n("mrP1"),w=n("L7w6"),I=n("GrRB"),P=n("2mMm"),M=n("0njA"),k=n("8r66"),T=[1,"container"],x=[1,"settings"],R=[1,"field"],E=["for","dependency","matTooltip","System to use for available status variables and function calls"],S=[3,"service","ngModel","ngModelChange"],A=[1,"action"],D=["mat-icon-button","",3,"disabled","tapped"],F=[3,"icon"],Y=[1,"text"],N=["class","list",4,"ngIf","ngIfElse"],J=["no_conditions",""],$=["no_actions",""],B=[1,"list"],L=[1,"header"],X=[1,"group","comparisons"],j=["class","item",4,"ngFor","ngForOf","ngForTrackBy"],q=[1,"group","time-dependents"],z=[1,"item"],V=[1,"handle"],Q=[1,"details"],G=["mat-icon-button","",3,"tapped"],U={class:"backoffice-edit"},W={class:"backoffice-trash"};function H(e,t){if(1&e){var n=i.fc();i.ec(0,"div",z),i.Yb(1,"div",V),i.ec(2,"div",Q),i.Tc(3),i.qc(4,"json"),i.qc(5,"json"),i.cc(),i.ec(6,"button",D),i.kc("tapped",function(e){i.Ec(n);var c=t.$implicit;return i.pc(2).editCondition(c)}),i.Yb(7,"app-icon",F),i.cc(),i.ec(8,"button",G),i.kc("tapped",function(e){i.Ec(n);var c=t.$implicit;return i.pc(2).confirmRemoveCondition(c)}),i.Yb(9,"app-icon",F),i.cc(),i.cc()}if(2&e){var c=t.$implicit,o=i.pc(2);i.Ic(3),i.Xc(" ",i.rc(4,6,c.left)," ",c.operator," ",i.rc(5,8,c.right)," "),i.Ic(6),i.vc("disabled",!o.template_system),i.Ic(7),i.vc("icon",U),i.Ic(9),i.vc("icon",W)}}function Z(e,t){if(1&e){var n=i.fc();i.ec(0,"div",z),i.Yb(1,"div",V),i.ec(2,"div",Q),i.Tc(3),i.cc(),i.ec(4,"button",D),i.kc("tapped",function(e){i.Ec(n);var c=t.$implicit;return i.pc(2).editCondition(c)}),i.Yb(5,"app-icon",F),i.cc(),i.ec(6,"button",G),i.kc("tapped",function(e){i.Ec(n);var c=t.$implicit;return i.pc(2).confirmRemoveCondition(c)}),i.Yb(7,"app-icon",F),i.cc(),i.cc()}if(2&e){var c=t.$implicit,o=i.pc(2);i.Ic(3),i.Wc(" ","at"===c.type?"At time":"CRON"," ","at"===c.type?c.time:c.cron," "),i.Ic(4),i.vc("disabled",!o.template_system),i.Ic(5),i.vc("icon",U),i.Ic(7),i.vc("icon",W)}}function K(e,t){if(1&e&&(i.ec(0,"div",B),i.ec(1,"div",L),i.Tc(2,"Variable Comparison Condtions"),i.cc(),i.ec(3,"div",X),i.Rc(4,H,10,10,"div",j),i.cc(),i.ec(5,"div",L),i.Tc(6,"Time Dependent Conditions"),i.cc(),i.ec(7,"div",q),i.Rc(8,Z,8,5,"div",j),i.cc(),i.cc()),2&e){var n=i.pc();i.Ic(4),i.vc("ngForOf",n.comparisons)("ngForTrackBy",n.i),i.Ic(8),i.vc("ngForOf",n.time_dependents)("ngForTrackBy",n.i)}}var ee=["cdkDropList","",1,"group","functions",3,"cdkDropListDropped"],te=["class","item","cdkDrag","",4,"ngFor","ngForOf","ngForTrackBy"],ne=["cdkDropList","",1,"group","emails",3,"cdkDropListDropped"],ie=["cdkDrag","",1,"item"],ce=["cdkDragHandle","",1,"handle"],oe=["class","placeholder",4,"cdkDragPlaceholder"],re=[1,"placeholder"];function se(e,t){1&e&&i.Yb(0,"div",re)}var ae={class:"backoffice-select-arrows"};function de(e,t){if(1&e){var n=i.fc();i.ec(0,"div",ie),i.ec(1,"div",ce),i.Yb(2,"app-icon",F),i.cc(),i.ec(3,"div",Q),i.Tc(4),i.qc(5,"json"),i.cc(),i.ec(6,"button",D),i.kc("tapped",function(e){i.Ec(n);var c=t.$implicit;return i.pc(2).editAction(c)}),i.Yb(7,"app-icon",F),i.cc(),i.ec(8,"button",G),i.kc("tapped",function(e){i.Ec(n);var c=t.$implicit;return i.pc(2).confirmRemoveAction(c)}),i.Yb(9,"app-icon",F),i.cc(),i.Rc(10,se,1,0,"div",oe),i.cc()}if(2&e){var c=t.$implicit,o=i.pc(2);i.Ic(2),i.vc("icon",ae),i.Ic(4),i.Xc(" ",c.mod,", ",c.method,"(",i.rc(5,7,c.args),") "),i.Ic(6),i.vc("disabled",!o.template_system),i.Ic(7),i.vc("icon",U),i.Ic(9),i.vc("icon",W)}}var ge=[3,"matTooltip"];function me(e,t){1&e&&i.Yb(0,"div",re)}function le(e,t){if(1&e){var n=i.fc();i.ec(0,"div",ie),i.ec(1,"div",ce),i.Yb(2,"app-icon",F),i.cc(),i.ec(3,"div",Q),i.ec(4,"span",ge),i.qc(5,"formatList"),i.Tc(6),i.cc(),i.Tc(7),i.cc(),i.ec(8,"button",D),i.kc("tapped",function(e){i.Ec(n);var c=t.$implicit;return i.pc(2).editAction(c)}),i.Yb(9,"app-icon",F),i.cc(),i.ec(10,"button",G),i.kc("tapped",function(e){i.Ec(n);var c=t.$implicit;return i.pc(2).confirmRemoveAction(c)}),i.Yb(11,"app-icon",F),i.cc(),i.Rc(12,me,1,0,"div",oe),i.cc()}if(2&e){var c=t.$implicit,o=i.pc(2);i.Ic(2),i.vc("icon",ae),i.Ic(4),i.vc("matTooltip",i.rc(5,8,c.emails)),i.Ic(6),i.Wc("",c.emails.length," Address",1===c.emails.length?"":"es",""),i.Ic(7),i.Vc(" | Body Length: ",c.content.length," "),i.Ic(8),i.vc("disabled",!o.template_system),i.Ic(9),i.vc("icon",U),i.Ic(11),i.vc("icon",W)}}function pe(e,t){if(1&e){var n=i.fc();i.ec(0,"div",B),i.ec(1,"div",L),i.Tc(2,"Function Call Actions"),i.cc(),i.ec(3,"div",ee),i.kc("cdkDropListDropped",function(e){return i.Ec(n),i.pc().confirmReorder("function",e)}),i.Rc(4,de,11,9,"div",te),i.cc(),i.ec(5,"div",L),i.Tc(6,"Email Actions"),i.cc(),i.ec(7,"div",ne),i.kc("cdkDropListDropped",function(e){return i.Ec(n),i.pc().confirmReorder("mailer",e)}),i.Rc(8,le,13,10,"div",te),i.cc(),i.cc()}if(2&e){var c=i.pc();i.Ic(4),i.vc("ngForOf",c.functions)("ngForTrackBy",c.i),i.Ic(8),i.vc("ngForOf",c.mailers)("ngForTrackBy",c.i)}}var fe=[1,"info-block"];function ue(e,t){1&e&&(i.ec(0,"div",fe),i.ec(1,"div",Y),i.Tc(2,"No condtions for trigger"),i.cc(),i.cc())}function he(e,t){1&e&&(i.ec(0,"div",fe),i.ec(1,"div",Y),i.Tc(2,"No actions for trigger"),i.cc(),i.cc())}var ve={class:"backoffice-plus"},be=function(e){function t(t,n){var i=e.call(this)||this;return i._service=t,i._dialog=n,i.comparisons=[],i.time_dependents=[],i.functions=[],i.mailers=[],i}return d.d(t,e),Object.defineProperty(t.prototype,"system_service",{get:function(){return this._service.Systems},enumerable:!0,configurable:!0}),t.prototype.ngOnChanges=function(e){e.item&&(this.item&&this.item.conditions&&(this.comparisons=this.item.conditions.comparisons||[],this.time_dependents=this.item.conditions.time_dependents||[],this.functions=this.item.actions.functions||[],this.mailers=this.item.actions.mailers||[]),this.confirm_ref&&(this.confirm_ref.close(),this.confirm_ref=null,this.unsub("delete_confirm")))},t.prototype.addCondition=function(){this._dialog.open(O.a,{width:"auto",height:"auto",data:{trigger:this.item,system:this.template_system}})},t.prototype.editCondition=function(e){this._dialog.open(O.a,{width:"auto",height:"auto",data:{trigger:this.item,condition:JSON.parse(JSON.stringify(e)),system:this.template_system}})},t.prototype.addAction=function(){this._dialog.open(C.a,{data:{trigger:this.item,system:this.template_system}})},t.prototype.editAction=function(e){this._dialog.open(C.a,{data:{trigger:this.item,action:e,system:this.template_system}})},t.prototype.confirmRemoveCondition=function(e){var t=this;this.confirm_ref=this._dialog.open(f.b,d.a({},f.a,{data:{title:"Remove trigger condition",content:"<p>Are you sure you want remove this trigger condition?</p><p>All systems using this trigger will be updated <strong>immediately</strong>.</p>",icon:{type:"icon",class:"backoffice-trash"}}})),this.subscription("delete_confirm",this.confirm_ref.componentInstance.event.subscribe(function(n){"done"===n.reason&&(t.confirm_ref.componentInstance.loading="Removing trigger condition...",t.removeCondition(e))}))},t.prototype.removeCondition=function(e){var t=this,n={comparisons:this.comparisons.slice(),time_dependents:this.time_dependents.slice()};if(e.type){var i=this.time_dependents.findIndex(function(t){return JSON.stringify(t)===JSON.stringify(e)});n.time_dependents.splice(i,1)}else i=this.comparisons.findIndex(function(t){return JSON.stringify(t)===JSON.stringify(e)}),n.comparisons.splice(i,1);this.item.storePendingChange("conditions",n),this.item.save().then(function(){return t._service.notifySuccess("Successfully removed trigger condition.")},function(e){return t._service.notifyError("Error removing trigger condition. Error: "+(e.message||e))})},t.prototype.confirmRemoveAction=function(e){var t=this;this.confirm_ref=this._dialog.open(f.b,d.a({},f.a,{data:{title:"Remove trigger action",content:"<p>Are you sure you want remove this trigger action?</p><p>All systems using this trigger will be updated <strong>immediately</strong>.</p>",icon:{type:"icon",class:"backoffice-trash"}}})),this.subscription("delete_confirm",this.confirm_ref.componentInstance.event.subscribe(function(n){"done"===n.reason&&(t.confirm_ref.componentInstance.loading="Removing trigger action...",t.removeAction(e))}))},t.prototype.removeAction=function(e){var t=this,n={functions:this.item.actions.functions.slice(),mailers:this.item.actions.mailers.slice()};if(e.emails){var i=this.mailers.findIndex(function(t){return JSON.stringify(t)===JSON.stringify(e)});n.mailers.splice(i,1)}else i=this.functions.findIndex(function(t){return JSON.stringify(t)===JSON.stringify(e)}),n.functions.splice(i,1);this.item.storePendingChange("actions",n),this.item.save().then(function(){return t._service.notifySuccess("Successfully removed trigger action.")},function(e){return t._service.notifyError("Error removing trigger action. Error: "+(e.message||e))})},t.prototype.confirmReorder=function(e,t){var n=this;this.confirm_ref=this._dialog.open(f.b,d.a({},f.a,{data:{title:"Reoreder trigger "+e+" action",content:"<p>Are you sure you want remove this trigger condition?</p><p>All systems using this trigger will be updated <strong>immediately</strong>.</p>",icon:{type:"icon",class:"backoffice-trash"}}})),this.subscription("delete_confirm",this.confirm_ref.componentInstance.event.subscribe(function(i){"done"===i.reason&&(n.confirm_ref.componentInstance.loading="Reordering trigger "+e+" action...",n.reorderAction(e,t))}))},t.prototype.reorderAction=function(e,t){var n=this,i=("function"===e?this.functions:this.mailers).slice();Object(s.f)(i,t.previousIndex,t.currentIndex),this.item.storePendingChange("actions",{functions:"function"===e?i:this.functions,mailers:"function"===e?this.mailers:i}),this.item.save().then(function(){return n._service.notifySuccess("Successfully re-ordered trigger "+e+" action.")},function(t){return n._service.notifyError("Error re-ordered trigger "+e+" action. Error: "+(t.message||t))})},t.ngComponentDef=i.Rb({type:t,selectors:[["trigger-about"]],factory:function(e){return new(e||t)(i.Xb(m.a),i.Xb(h.b))},inputs:{item:"item"},features:[i.Fb,i.Gb()],consts:27,vars:10,template:function(e,t){if(1&e&&(i.ec(0,"div",T),i.ec(1,"div",x),i.ec(2,"section"),i.ec(3,"div",R),i.ec(4,"label",E),i.Tc(5,"Template System: "),i.cc(),i.ec(6,"item-search-field",S),i.kc("ngModelChange",function(e){return t.template_system=e}),i.cc(),i.cc(),i.cc(),i.ec(7,"header"),i.ec(8,"div",A),i.ec(9,"button",D),i.kc("tapped",function(e){return t.addCondition()}),i.Yb(10,"app-icon",F),i.cc(),i.cc(),i.ec(11,"div",Y),i.Tc(12,"Conditions"),i.cc(),i.cc(),i.ec(13,"section"),i.Rc(14,K,9,4,"div",N),i.cc(),i.ec(15,"header"),i.ec(16,"div",A),i.ec(17,"button",D),i.kc("tapped",function(e){return t.addAction()}),i.Yb(18,"app-icon",F),i.cc(),i.cc(),i.ec(19,"div",Y),i.Tc(20,"Actions"),i.cc(),i.cc(),i.ec(21,"section"),i.Rc(22,pe,9,4,"div",N),i.cc(),i.cc(),i.cc(),i.Rc(23,ue,3,0,"ng-template",null,J,i.Sc),i.Rc(25,he,3,0,"ng-template",null,$,i.Sc)),2&e){var n=i.Bc(24),c=i.Bc(26);i.Ic(6),i.vc("service",t.system_service)("ngModel",t.template_system),i.Ic(9),i.vc("disabled",!t.template_system),i.Ic(10),i.vc("icon",ve),i.Ic(14),i.vc("ngIf",t.comparisons.length||t.time_dependents.length)("ngIfElse",n),i.Ic(17),i.vc("disabled",!t.template_system),i.Ic(18),i.vc("icon",ve),i.Ic(22),i.vc("ngIf",t.functions.length||t.mailers.length)("ngIfElse",c)}},directives:[w.a,I.a,o.k,o.n,P.b,b.b,M.a,c.n,c.m,s.d,s.a,s.b,s.c],pipes:[c.g,k.a],styles:['.container[_ngcontent-%COMP%]{padding:1em}header[_ngcontent-%COMP%]{display:flex;align-items:center;font-weight:700;font-size:1.1em}section[_ngcontent-%COMP%]{padding:.5em .25em}.no-item[_ngcontent-%COMP%]{font-size:.75em}.group[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;width:100%}.item[_ngcontent-%COMP%]{display:flex;align-items:center;border-radius:4px;margin:2px 0;width:100%}.item[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:2.5rem;width:2.5rem}.item[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.item[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{flex:1;min-width:50%;font-family:"Fira Code",monospace;white-space:nowrap;font-size:.6em;padding:0 .5rem;overflow:hidden;text-overflow:ellipsis}.item[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-family:"Fira Code",monospace}.item[_ngcontent-%COMP%]:nth-child(2n){background-color:#f0f0f0}.item[_ngcontent-%COMP%]:hover{background-color:#ccc}button[_ngcontent-%COMP%]{margin:.25em}header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 .5em 0 0;border:1px solid rgba(0,0,0,.85)}header[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{border-color:#ccc}.header[_ngcontent-%COMP%]{padding:1em;font-size:1em;font-weight:500}.cdk-drag-preview[_ngcontent-%COMP%]{background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 0 rgba(0,0,0,.12)}.cdk-drag-preview[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:none}.placeholder[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.1);border:4px dashed rgba(0,0,0,.6);height:3em;width:100%;border-radius:4px}']}),t}(y.a),_e=n("oIn+"),ye=[1,"container"],Ce=[1,"settings"],Oe=[4,"ngIf","ngIfElse"],we=["empty_state",""],Ie=[1,"small"],Pe=[1,"flex"],Me=[4,"ngFor","ngForOf"],ke=[1,"state"],Te=[3,"routerLink",4,"ngIf"],xe=["mat-icon-button","",3,"tapped"],Re=[3,"icon"],Ee=[3,"routerLink"],Se=[1,"id"],Ae=function(e){return["/systems",e]};function De(e,t){if(1&e&&(i.ec(0,"a",Ee),i.Tc(1),i.ec(2,"span",Se),i.Tc(3),i.cc(),i.Tc(4,") "),i.cc()),2&e){var n=i.pc().$implicit;i.vc("routerLink",i.wc(3,Ae,n.system_id)),i.Ic(1),i.Vc(" ",n.system_name," ("),i.Ic(3),i.Uc(n.system_id)}}var Fe={class:"backoffice-trash"};function Ye(e,t){if(1&e){var n=i.fc();i.ec(0,"tr"),i.ec(1,"td",Ie),i.ec(2,"div",ke),i.Pc(),i.cc(),i.cc(),i.ec(3,"td",Pe),i.Rc(4,De,5,5,"a",Te),i.cc(),i.ec(5,"td"),i.Tc(6),i.qc(7,"dateFrom"),i.cc(),i.ec(8,"td",Ie),i.ec(9,"button",xe),i.kc("tapped",function(e){i.Ec(n);var c=t.$implicit;return i.pc(2).delete(c)}),i.Yb(10,"app-icon",Re),i.cc(),i.cc(),i.cc()}if(2&e){var c=t.$implicit;i.Ic(2),i.Mb("active",c.enabled),i.Qc(),i.Ic(4),i.vc("ngIf",c.system_id),i.Ic(6),i.Uc(i.rc(7,4,1e3*(c.created_at-0))),i.Ic(10),i.vc("icon",Fe)}}function Ne(e,t){if(1&e&&(i.ec(0,"table"),i.ec(1,"thead"),i.Yb(2,"td",Ie),i.ec(3,"td",Pe),i.Tc(4,"Name"),i.cc(),i.ec(5,"td",Pe),i.Tc(6,"Added"),i.cc(),i.Yb(7,"td",Ie),i.cc(),i.ec(8,"tbody"),i.Rc(9,Ye,11,6,"tr",Me),i.cc(),i.cc()),2&e){var n=i.pc();i.Ic(9),i.vc("ngForOf",n.system_trigger_list)}}var Je=[1,"info-block"],$e=[1,"text"];function Be(e,t){1&e&&(i.ec(0,"div",Je),i.ec(1,"div",$e),i.Tc(2,"No systems with trigger"),i.cc(),i.cc())}var Le=function(e){function t(t,n,i){var c=e.call(this)||this;return c._service=t,c._dialog=n,c._composer=i,c.system_trigger_list=[],c.connected={},c}return d.d(t,e),t.prototype.ngOnChanges=function(e){e.item&&this.loadSystemTriggers()},t.prototype.loadSystemTriggers=function(e){var t=this;void 0===e&&(e=0),this._service.SystemTriggers.query({trigger_id:this.item.id,offset:e}).then(function(e){return t.system_trigger_list=e||[]},function(){return null})},t.prototype.delete=function(e){var t=this;if(e){var n=this._dialog.open(f.b,d.a({},f.a,{data:{title:"Remove trigger",content:'<p>Are you sure you want remove this trigger?</p><p>Deleting this trigger will <strong>immediately</strong> remove from the system "'+(e.system_name||"")+'"</p>',icon:{type:"icon",class:"backoffice-trash"}}}));this.subscription("delete_confirm",n.componentInstance.event.subscribe(function(i){return d.b(t,void 0,void 0,function(){var t=this;return d.e(this,function(c){switch(c.label){case 0:return"done"!==i.reason?[3,2]:(n.componentInstance.loading="Removing trigger...",[4,this.deleteTrigger(e).catch(function(e){throw n.componentInstance.loading=null,t._service.notifyError("Error removing trigger. Error: "+(e.message||e)),e})]);case 1:c.sent(),this.loadSystemTriggers(),n.close(),this.unsub("delete_confirm"),c.label=2;case 2:return[2]}})})}))}},t.prototype.deleteTrigger=function(e){var t=this;return new Promise(function(n,i){t._composer.http.delete(t._composer.auth.api_endpoint+"/systems/"+e.system_id+"/triggers/"+e.id).subscribe(function(e){return null},function(e){return i(e)},function(){return n()})})},t.ngComponentDef=i.Rb({type:t,selectors:[["trigger-systems"]],factory:function(e){return new(e||t)(i.Xb(m.a),i.Xb(h.b),i.Xb(a.c))},inputs:{item:"item"},features:[i.Fb,i.Gb()],consts:5,vars:2,template:function(e,t){if(1&e&&(i.ec(0,"div",ye),i.ec(1,"div",Ce),i.Rc(2,Ne,10,1,"table",Oe),i.cc(),i.cc(),i.Rc(3,Be,3,0,"ng-template",null,we,i.Sc)),2&e){var n=i.Bc(4);i.Ic(2),i.vc("ngIf",t.system_trigger_list.length>0)("ngIfElse",n)}},directives:[c.n,c.m,P.b,b.b,M.a,r.f],pipes:[_e.a],styles:[".container[_ngcontent-%COMP%]{padding:1em}.list[_ngcontent-%COMP%]{margin-top:.5em}tbody[_ngcontent-%COMP%]{font-size:.9em}tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-overflow:ellipsis;white-space:nowrap}div[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]{width:2em}div[_ngcontent-%COMP%]   .duo[_ngcontent-%COMP%]{width:4em}div[_ngcontent-%COMP%]   .duo[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{display:inline-flex}.action[_ngcontent-%COMP%]{height:1.5em;width:1.5em;min-width:1.5em;border-radius:.65em;display:flex;align-items:center;justify-content:center;font-size:1.3em}.action[_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.1)}.state[_ngcontent-%COMP%]{height:1.5em;width:1.5em;margin:.25em;background-color:#000;border-radius:.8em;transition:margin 250ms,height 250ms,width 250ms,background-color .3s}.state.active[_ngcontent-%COMP%]{background-color:#4caf50;height:.75em;width:.75em;margin:.625em}.select[_ngcontent-%COMP%]{display:flex;align-items:center}.select[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{flex:1}"]}),t}(y.a),Xe=[1,"container"],je=[1,"sidebar"],qe=["heading","Triggers",3,"module","close","searchChange","event"],ze=[3,"touchrelease"],Ve=["name","trigger",3,"item","loading","active","tabs","event"],Qe=["about",""],Ge=["systems",""],Ue=[3,"item"];function We(e,t){if(1&e&&i.Yb(0,"trigger-about",Ue),2&e){var n=i.pc();i.vc("item",n.item)}}function He(e,t){if(1&e&&i.Yb(0,"trigger-systems",Ue),2&e){var n=i.pc();i.vc("item",n.item)}}var Ze={class:"backoffice-info-with-circle"},Ke=function(e){return{id:"about",name:"About",template:e,icon:Ze}},et={class:"backoffice-documents"},tt=function(e,t){return{id:"systems",name:"Systems",template:e,count:t,icon:et}},nt=function(e,t){return[e,t]},it=function(e){function t(t,n,i,c){var o=e.call(this,t,n,i)||this;return o._service=t,o._route=n,o._router=i,o._dialog=c,o.service=o._service.Triggers,o}return d.d(t,e),t.prototype.loadValues=function(){var e=this,t={offset:0,limit:1,trigger_id:this.item.id};Object(p.b)(t),this._service.SystemTriggers.query(t).then(function(){return e.system_count=e._service.SystemTriggers.last_total})},t.prototype.new=function(){this._dialog.open(u.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:new g.o(this._service.Triggers,{}),service:this._service.Triggers}})},t.prototype.edit=function(){this.item&&this._dialog.open(u.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:this.item,service:this._service.Triggers}})},t.prototype.delete=function(){var e=this;if(this.item){var t=this._dialog.open(f.b,d.a({},f.a,{data:{title:"Delete trigger",content:"<p>Are you sure you want delete this trigger?</p><p>Deleting this trigger will <strong>immediately</strong> remove it from all associated systems and zones</p>",icon:{type:"icon",class:"backoffice-trash"}}}));this.subscription("delete_confirm",t.componentInstance.event.subscribe(function(n){return d.b(e,void 0,void 0,function(){var e=this;return d.e(this,function(i){switch(i.label){case 0:return"done"!==n.reason?[3,2]:(t.componentInstance.loading="Deleting trigger...",[4,this.item.delete().catch(function(n){throw t.componentInstance.loading=null,e._service.notifyError("Error deleting trigger. Error: "+(n.message||n)),n})]);case 1:i.sent(),this._router.navigate(["/triggers"]),t.close(),this.unsub("delete_confirm"),i.label=2;case 2:return[2]}})})}))}},t.ngComponentDef=i.Rb({type:t,selectors:[["app-triggers"]],factory:function(e){return new(e||t)(i.Xb(m.a),i.Xb(r.a),i.Xb(r.c),i.Xb(h.b))},features:[i.Fb],consts:9,vars:15,template:function(e,t){if(1&e&&(i.ec(0,"div",Xe),i.Pc(),i.ec(1,"div",je),i.ec(2,"sidebar",qe),i.kc("searchChange",function(e){return t.search(e)}),i.kc("event",function(e){return t.sidebarEvent(e)}),i.cc(),i.cc(),i.ec(3,"main",ze),i.kc("touchrelease",function(e){return t.show_sidebar=!1}),i.ec(4,"item-display",Ve),i.kc("event",function(e){return t.itemEvent(e)}),i.Rc(5,We,1,1,"ng-template",null,Qe,i.Sc),i.Rc(7,He,1,1,"ng-template",null,Ge,i.Sc),i.cc(),i.cc(),i.cc()),2&e){var n=i.Bc(6),c=i.Bc(8);i.Mb("show",t.show_sidebar),i.Qc(),i.Ic(2),i.vc("module",t.module)("close",t.show_sidebar),i.Ic(4),i.vc("item",t.item)("loading",t.loading_item)("active",t.tab)("tabs",i.xc(12,nt,i.wc(7,Ke,n),i.xc(9,tt,c,t.system_count)))}},directives:[v.a,b.b,_.a,be,Le],styles:[".container[_ngcontent-%COMP%]{display:flex;align-items:center;height:100%;width:100%}.sidebar[_ngcontent-%COMP%]{height:100%;width:20em}@media only screen and (orientation:portrait) and (max-width:450px){.container[_ngcontent-%COMP%]{flex-direction:column}.container.show[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{height:100%}.container.show[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{height:0%}.sidebar[_ngcontent-%COMP%]{height:3em;min-height:3em;width:100%;transition:height .3s}main[_ngcontent-%COMP%]{transition:height .3s;width:100%}}@media only screen and (orientation:landscape) and (max-width:800px){.container[_ngcontent-%COMP%]{flex-direction:column}.container.show[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{height:100%}.container.show[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{height:0%}.sidebar[_ngcontent-%COMP%]{height:3em;min-height:3em;width:100%;transition:height .3s}main[_ngcontent-%COMP%]{transition:height .3s;width:100%}}main[_ngcontent-%COMP%]{position:relative;height:100%;overflow:hidden;flex:1;background-color:#f0f0f0}"]}),t}(l.a),ct=[{path:"",component:it,children:[]},{path:":id",component:it,children:[]},{path:"**",redirectTo:""}],ot=n("PCNd");n.d(t,"AppTriggersModule",function(){return rt});var rt=function(){function e(){}return e.ngModuleDef=i.Vb({type:e}),e.ngInjectorDef=i.Ub({factory:function(t){return new(t||e)},imports:[[c.c,o.g,a.b,r.g.forChild(ct),ot.a,s.e]]}),e}();r.g.forChild(ct)}}]);