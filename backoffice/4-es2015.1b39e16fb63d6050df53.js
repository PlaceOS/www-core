(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{jtLk:function(e,t,n){"use strict";n.r(t);var c=n("fXoL"),i=n("ofXK"),s=n("3Pt+"),o=n("tyNb"),a=n("CcG0"),r=n("UN3I"),d=n("OaWH"),l=n("C/ya"),h=n("D/9M"),m=n("g+Po"),g=n("LcAk"),u=n("BAfr"),f=n("TEMH"),p=n("m6yr"),v=n("47y3"),_=n("5f3J"),b=n("YxBP"),y=n("Xlwt"),C=n("rUqb");const M=[1,"container"],w=[1,"settings"],O=["mat-button",""],P=[3,"touchrelease"],x=[3,"ngModel","readonly"],I=(()=>{class e extends _.a{constructor(e){super(),this._service=e}ngOnChanges(e){e.item&&(this.loadDependency(),this.loadSystem())}loadDependency(){this.item&&this.item.dependency_id&&this._service.Drivers.show(this.item.dependency_id).then(e=>{this.dependency=e,this.updateSettings()})}loadSystem(){this.item&&this.item.system_id&&this._service.Systems.show(this.item.system_id).then(e=>{this.system=e,this.updateSettings()})}toggleSettings(){this.merged=!1===this.merged,this.updateSettings()}updateSettings(){this.item&&(!1!==this.merged?(this.settings=Object(b.b)("",this.item.settings.settings_string||""),this.dependency&&(this.settings=Object(b.b)(this.settings,this.dependency.settings.settings_string||""))):this.settings=this.item.settings.settings_string||"")}}return e.ngComponentDef=c.Rb({type:e,selectors:[["device-about"]],factory:function(t){return new(t||e)(c.Xb(d.a))},inputs:{item:"item"},features:[c.Fb,c.Gb()],consts:15,vars:4,template:function(e,t){1&e&&(c.ec(0,"div",M),c.ec(1,"div",w),c.ec(2,"header"),c.Tc(3,"Logic for system:\xa0"),c.ec(4,"span"),c.Tc(5),c.cc(),c.cc(),c.ec(6,"section"),c.ec(7,"button",O),c.Tc(8,"Stop Device"),c.cc(),c.cc(),c.ec(9,"header"),c.Tc(10,"Settings "),c.ec(11,"span",P),c.kc("touchrelease",function(e){return t.toggleSettings()}),c.Tc(12),c.cc(),c.cc(),c.ec(13,"section"),c.Yb(14,"settings-form-field",x),c.cc(),c.cc(),c.cc()),2&e&&(c.Ic(5),c.Uc(null==t.system?null:t.system.name),c.Ic(12),c.Uc(!1===t.merged?"This module":"Merged"),c.Ic(14),c.vc("ngModel",t.settings)("readonly",!0))},directives:[y.b,p.b,C.a,s.k,s.n],styles:[".container[_ngcontent-%COMP%]{padding:1em}header[_ngcontent-%COMP%]{display:flex;align-items:center;font-weight:700;font-size:1.1em}header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.7em;color:rgba(0,0,0,.6);padding:0 1em;font-weight:300;text-decoration:underline;cursor:pointer;transition:color .2s}header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:hover{color:rgba(0,0,0,.85)}section[_ngcontent-%COMP%]{padding:.5em .25em}"]}),e})();var k=n("XNiG"),S=n("LRne"),T=n("Kj3r"),D=n("/uUt"),j=n("eIep"),L=n("JIr8"),R=n("lJxs"),X=n("IRfi"),U=n("0njA"),A=n("A2Vd");const E=[1,"container"],$=[1,"btn"],q=["appearance","outline"],F=["matPrefix","",1,"prefix"],N=[3,"icon"],B=["matInput","","name","search-filter","placeholder","Filter Systems",3,"ngModel","ngModelChange"],J=["class","list",4,"ngIf","ngIfElse"],Y=["empty_state",""],G=[1,"list"],H=[1,"flex"],V=[1,"devices"],z=[1,"created"],W=[4,"ngFor","ngForOf"],K=["routerLinkActive","router-link-active",3,"routerLink"],Q=[1,"id"],Z=function(e){return["/systems",e]};function ee(e,t){if(1&e&&(c.ec(0,"tr"),c.ec(1,"td",H),c.ec(2,"a",K),c.Tc(3),c.ec(4,"span",Q),c.Tc(5),c.cc(),c.Tc(6,") "),c.cc(),c.cc(),c.ec(7,"td",V),c.Tc(8),c.cc(),c.ec(9,"td",z),c.Tc(10),c.cc(),c.cc()),2&e){const e=t.$implicit;c.Ic(2),c.vc("routerLink",c.wc(5,Z,e.id)),c.Ic(3),c.Vc(" ",e.name," ("),c.Ic(5),c.Uc(e.id),c.Ic(8),c.Uc(e.installed_ui_devices),c.Ic(10),c.Uc(null==e.display?null:e.display.created)}}function te(e,t){if(1&e&&(c.ec(0,"div",G),c.ec(1,"table"),c.ec(2,"thead"),c.ec(3,"td",H),c.Tc(4,"Name"),c.cc(),c.ec(5,"td",V),c.Tc(6,"No. Devices"),c.cc(),c.ec(7,"td",z),c.Tc(8,"Created"),c.cc(),c.cc(),c.ec(9,"tbody"),c.Rc(10,ee,11,7,"tr",W),c.cc(),c.cc(),c.cc()),2&e){const e=c.pc();c.Ic(10),c.vc("ngForOf",e.system_list)}}const ne=[1,"info-block"],ce=[1,"text"];function ie(e,t){1&e&&(c.ec(0,"div",ne),c.ec(1,"div",ce),c.Tc(2,"No matching systems found"),c.cc(),c.cc())}const se={class:"backoffice-magnifying-glass"},oe=(()=>{class e extends _.a{constructor(e){super(),this.service=e,this.search$=new k.a}ngOnInit(){this.search_results$=this.search$.pipe(Object(T.a)(400),Object(D.a)(),Object(j.a)(e=>(this.loading=!0,this.service.Systems.query({q:e,module_id:this.item.id,offset:0}))),Object(L.a)(e=>(console.error(e),Object(S.a)([]))),Object(R.a)(e=>{this.loading=!1;const t=this.search_str.toLowerCase();return e.filter(e=>e.name.toLowerCase().indexOf(t)>=0||(e.email||"").toLowerCase().indexOf(t)>=0)})),this.subscription("search_results",this.search_results$.subscribe(e=>this.system_list=e))}ngOnChanges(e){e.item&&this.loadSystems()}loadSystems(e=0){this.service.Systems.query({module_id:this.item.id,offset:e}).then(e=>{this.system_list=e},()=>null)}}return e.ngComponentDef=c.Rb({type:e,selectors:[["device-systems"]],factory:function(t){return new(t||e)(c.Xb(d.a))},inputs:{item:"item"},features:[c.Fb,c.Gb()],consts:9,vars:4,template:function(e,t){if(1&e&&(c.ec(0,"div",E),c.ec(1,"div",$),c.ec(2,"mat-form-field",q),c.ec(3,"div",F),c.Yb(4,"app-icon",N),c.cc(),c.ec(5,"input",B),c.kc("ngModelChange",function(e){return t.search_str=e}),c.kc("ngModelChange",function(e){return t.search$.next(e)}),c.cc(),c.cc(),c.cc(),c.Rc(6,te,11,1,"div",J),c.cc(),c.Rc(7,ie,3,0,"ng-template",null,Y,c.Sc)),2&e){const e=c.Bc(8);c.Ic(4),c.vc("icon",se),c.Ic(5),c.vc("ngModel",t.search_str),c.Ic(6),c.vc("ngIf",t.system_list&&t.system_list.length>0)("ngIfElse",e)}},directives:[X.b,X.e,U.a,A.a,s.b,s.k,s.n,i.n,i.m,o.f,o.e],styles:[".container[_ngcontent-%COMP%]{padding:1em}mat-form-field[_ngcontent-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:1.25em}.list[_ngcontent-%COMP%]{margin-top:.5em}.table-row[_ngcontent-%COMP%]   .created[_ngcontent-%COMP%], .table-row[_ngcontent-%COMP%]   .devices[_ngcontent-%COMP%]{width:8em;min-width:8em}"]}),e})(),ae=[1,"container"],re=[1,"sidebar"],de=["heading","Devices",3,"module","close","queryParams","searchChange","event"],le=[1,"toggle"],he=["labelPosition","before",3,"ngModel","ngModelChange"],me=[3,"touchrelease"],ge=["name","device",3,"item","active","tabs","event"],ue=["about",""],fe=["systems",""],pe=[3,"item"];function ve(e,t){if(1&e&&c.Yb(0,"device-about",pe),2&e){const e=c.pc();c.vc("item",e.item)}}function _e(e,t){if(1&e&&c.Yb(0,"device-systems",pe),2&e){const e=c.pc();c.vc("item",e.item)}}const be={connected:!1,running:!0},ye={},Ce={class:"backoffice-info-with-circle"},Me=function(e){return{id:"about",name:"About",template:e,icon:Ce}},we={class:"backoffice-documents"},Oe=function(e,t){return{id:"systems",name:"Systems",template:e,count:t,icon:we}},Pe=function(e,t){return[e,t]},xe=(()=>{class e extends l.a{constructor(e,t,n,c){super(e,t,n),this._service=e,this._route=t,this._router=n,this._dialog=c,this.service=this._service.Modules}loadValues(){this._service.Systems.query({offset:0,limit:1,module_id:this.item.id}).then(()=>{this.system_count=this._service.Systems.last_total})}new(){this._dialog.open(h.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:new r.g(this._service.Modules,{}),service:this._service.Modules}})}edit(){this.item&&this._dialog.open(h.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:this.item,service:this._service.Modules}})}delete(){if(this.item){const e=this._dialog.open(m.b,Object.assign({},m.a,{data:{title:"Delete device",content:"<p>Are you sure you want delete this device?</p><p>Deleting this will device <strong>immediately</strong> remove it from any system associated with it</p>",icon:{type:"icon",class:"backoffice-trash"}}}));this.subscription("delete_confirm",e.componentInstance.event.subscribe(t=>{"done"===t.reason&&(e.componentInstance.loading="Deleting device...",this.item.delete().then(()=>{this._service.notifySuccess(`Successfully deleted device "${this.item.name}".`),this._router.navigate(["/modules"]),e.close(),this.unsub("delete_confirm")},t=>{e.componentInstance.loading=null,this._service.notifyError(`Error deleting device. Error: ${t}`)}))}))}}}return e.ngComponentDef=c.Rb({type:e,selectors:[["app-devices"]],factory:function(t){return new(t||e)(c.Xb(d.a),c.Xb(o.a),c.Xb(o.c),c.Xb(g.b))},features:[c.Fb],consts:12,vars:16,template:function(e,t){if(1&e&&(c.ec(0,"div",ae),c.Pc(),c.ec(1,"div",re),c.ec(2,"sidebar",de),c.kc("searchChange",function(e){return t.search(e)}),c.kc("event",function(e){return t.sidebarEvent(e)}),c.ec(3,"div",le),c.ec(4,"mat-slide-toggle",he),c.kc("ngModelChange",function(e){return t.only_disconnected=e}),c.Tc(5," Only Disconnected "),c.cc(),c.cc(),c.cc(),c.cc(),c.ec(6,"main",me),c.kc("touchrelease",function(e){return t.show_sidebar=!1}),c.ec(7,"item-display",ge),c.kc("event",function(e){return t.itemEvent(e)}),c.Rc(8,ve,1,1,"ng-template",null,ue,c.Sc),c.Rc(10,_e,1,1,"ng-template",null,fe,c.Sc),c.cc(),c.cc(),c.cc()),2&e){const e=c.Bc(9),n=c.Bc(11);c.Mb("show",t.show_sidebar),c.Qc(),c.Ic(2),c.vc("module",t.module)("close",t.show_sidebar)("queryParams",t.only_disconnected?be:ye),c.Ic(4),c.vc("ngModel",t.only_disconnected),c.Ic(7),c.vc("item",t.item)("active",t.tab)("tabs",c.xc(13,Pe,c.wc(8,Me,e),c.xc(10,Oe,n,t.system_count)))}},directives:[u.a,f.a,s.k,s.n,p.b,v.a,I,oe],styles:[".container[_ngcontent-%COMP%]{display:flex;align-items:center;height:100%;width:100%}.sidebar[_ngcontent-%COMP%]{height:100%;width:20em}@media only screen and (orientation:portrait) and (max-width:450px){.container[_ngcontent-%COMP%]{flex-direction:column}.container.show[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{height:100%}.container.show[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{height:0%}.sidebar[_ngcontent-%COMP%]{height:3em;min-height:3em;width:100%;transition:height .3s}main[_ngcontent-%COMP%]{transition:height .3s;width:100%}}@media only screen and (orientation:landscape) and (max-width:800px){.container[_ngcontent-%COMP%]{flex-direction:column}.container.show[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{height:100%}.container.show[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{height:0%}.sidebar[_ngcontent-%COMP%]{height:3em;min-height:3em;width:100%;transition:height .3s}main[_ngcontent-%COMP%]{transition:height .3s;width:100%}}main[_ngcontent-%COMP%]{position:relative;height:100%;overflow:hidden;flex:1;background-color:#f0f0f0}.toggle[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;padding-right:1em}"]}),e})(),Ie=[{path:"",component:xe,children:[]},{path:":id",component:xe,children:[]},{path:"**",redirectTo:""}];var ke=n("PCNd");n.d(t,"AppDevicesModule",function(){return Se});const Se=(()=>{class e{}return e.ngModuleDef=c.Vb({type:e}),e.ngInjectorDef=c.Ub({factory:function(t){return new(t||e)},imports:[[i.c,s.g,a.b,o.g.forChild(Ie),ke.a]]}),e})();o.g.forChild(Ie)}}]);