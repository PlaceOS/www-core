(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{aCzL:function(t,e,n){"use strict";n.r(e);var c=n("TYT/"),i=n("Valr"),o=n("QJY3"),a=n("DUip"),r=n("pS6y"),s=n("mrSG"),l=n("UN3I"),d=n("OaWH"),m=n("C/ya"),u=n("D/9M"),h=n("g+Po"),p=n("QrbZ"),f=n("BAfr"),g=n("ZwpQ"),v=n("47y3"),b=n("5f3J"),_=n("2mMm"),w=n("0njA"),y=[1,"container"],C=[1,"select"],O=["mat-button","",3,"tapped"],M=["class","list",4,"ngIf"],P=["class","info-block",4,"ngIf"],I=[1,"list"],k=[1,"name"],x=[1,"flex"],A=[1,"scope"],T=[1,"duo"],R=[4,"ngFor","ngForOf"],D=["mat-icon-button","",3,"tapped"],U=[3,"icon"],F={class:"backoffice-edit"},S={class:"backoffice-trash"};function E(t,e){if(1&t){var n=c.fc();c.ec(0,"tr"),c.ec(1,"td",k),c.Tc(2),c.cc(),c.ec(3,"td",x),c.Tc(4),c.cc(),c.ec(5,"td",A),c.Tc(6),c.cc(),c.ec(7,"td",T),c.ec(8,"button",D),c.kc("tapped",function(t){c.Ec(n);var i=e.$implicit;return c.pc(2).editApplication(i)}),c.Yb(9,"app-icon",U),c.cc(),c.ec(10,"button",D),c.kc("tapped",function(t){c.Ec(n);var i=e.$implicit;return c.pc(2).deleteApplication(i)}),c.Yb(11,"app-icon",U),c.cc(),c.cc(),c.cc()}if(2&t){var i=e.$implicit;c.Ic(2),c.Uc(i.name),c.Ic(4),c.Uc(i.redirect),c.Ic(6),c.Uc(i.scope),c.Ic(9),c.vc("icon",F),c.Ic(11),c.vc("icon",S)}}function Y(t,e){if(1&t&&(c.ec(0,"div",I),c.ec(1,"table"),c.ec(2,"thead"),c.ec(3,"td",k),c.Tc(4,"Name"),c.cc(),c.ec(5,"td",x),c.Tc(6,"Redirect"),c.cc(),c.ec(7,"td",A),c.Tc(8,"Scope"),c.cc(),c.Yb(9,"td",T),c.cc(),c.ec(10,"tbody"),c.Rc(11,E,12,5,"tr",R),c.cc(),c.cc(),c.cc()),2&t){var n=c.pc();c.Ic(11),c.vc("ngForOf",n.application_list)}}var N=[1,"info-block"],X=[1,"text"];function j(t,e){1&t&&(c.ec(0,"div",N),c.ec(1,"div",X),c.Tc(2,"No applications found"),c.cc(),c.cc())}var z=function(t){function e(e,n){var c=t.call(this)||this;return c._service=e,c._dialog=n,c}return s.d(e,t),e.prototype.ngOnChanges=function(t){t.item&&this.loadApplications()},e.prototype.loadApplications=function(t){var e=this;void 0===t&&(t=0),this._service.Applications.query({owner:this.item.id,offset:t}).then(function(n){t||(e.application_list=[]);for(var c=0,i=n||[];c<i.length;c++){for(var o=i[c],a=!1,r=0,s=e.application_list;r<s.length;r++)if(s[r].id===o.id){a=!0;break}a||e.application_list.push(o)}},function(){return null})},e.prototype.newApplication=function(){this._dialog.open(u.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:new l.c(this._service.Applications,{}),service:this._service.Applications}})},e.prototype.editApplication=function(t){this.item&&this._dialog.open(u.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:t,service:this._service.Applications}})},e.prototype.deleteApplication=function(t){var e=this;if(t){var n=this._dialog.open(h.b,s.a({},h.a,{data:{title:"Delete application",content:"<p>Are you sure you want delete the application "+t.name+"?</p><p>Configuration will be <strong>immediately</strong> updated</p>",icon:{type:"icon",class:"backoffice-trash"}}}));this.subscription("delete_confirm",n.componentInstance.event.subscribe(function(c){"done"===c.reason&&(n.componentInstance.loading="Deleting application...",t.delete().then(function(){e._service.notifySuccess('Successfully deleted application "'+t.name+'".'),e.loadApplications(),n.close(),e.unsub("delete_confirm")},function(t){n.componentInstance.loading=null,e._service.notifyError("Error deleting application. Error: "+t)}))}))}},e.ngComponentDef=c.Rb({type:e,selectors:[["domain-applications"]],factory:function(t){return new(t||e)(c.Xb(d.a),c.Xb(p.b))},inputs:{item:"item"},features:[c.Fb,c.Gb()],consts:7,vars:2,template:function(t,e){1&t&&(c.ec(0,"div",y),c.ec(1,"section",C),c.ec(2,"button",O),c.kc("tapped",function(t){return e.newApplication()}),c.Tc(3,"Add new"),c.cc(),c.cc(),c.ec(4,"section"),c.Rc(5,Y,12,1,"div",M),c.Rc(6,j,3,0,"div",P),c.cc(),c.cc()),2&t&&(c.Ic(5),c.vc("ngIf",e.application_list&&e.application_list.length>0),c.Ic(6),c.vc("ngIf",!e.application_list||e.application_list.length<=0))},directives:[_.b,g.b,i.n,i.m,w.a],styles:[".container[_ngcontent-%COMP%]{padding:1em}.options[_ngcontent-%COMP%]{display:flex;font-size:1.2em;max-width:5em;margin:0}.state[_ngcontent-%COMP%]{height:1.5em;width:1.5em;margin:.25em;background-color:#000;border-radius:.8em;transition:margin 250ms,height 250ms,width 250ms,background-color .3s}.state.active[_ngcontent-%COMP%]{background-color:#4caf50;height:.75em;width:.75em;margin:.625em}.duo[_ngcontent-%COMP%]{width:6em}.table-row[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%], .table-row[_ngcontent-%COMP%]   .scope[_ngcontent-%COMP%]{width:8em;min-width:8em}.select[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}section[_ngcontent-%COMP%]{padding:.5em .25em}"]}),e}(b.a),q=[1,"container"],H=[1,"select"],W=["mat-button",""],$=["class","list",4,"ngIf"],B=["class","info-block",4,"ngIf"],G=[1,"list"],J=[1,"name"],Q=[1,"flex"],V=[1,"duo"],L=[4,"ngFor","ngForOf"],Z=[1,"action"],K=[1,"backoffice-edit"],tt=[1,"backoffice-trash"];function et(t,e){if(1&t&&(c.ec(0,"tr"),c.ec(1,"td",J),c.Tc(2),c.cc(),c.ec(3,"td",Q),c.Tc(4),c.cc(),c.ec(5,"td",V),c.ec(6,"div",Z),c.Yb(7,"i",K),c.cc(),c.ec(8,"div",Z),c.Yb(9,"i",tt),c.cc(),c.cc(),c.cc()),2&t){var n=e.$implicit;c.Ic(2),c.Uc(n.name),c.Ic(4),c.Uc(n.redirect)}}function nt(t,e){if(1&t&&(c.ec(0,"div",G),c.ec(1,"table"),c.ec(2,"thead"),c.ec(3,"td",J),c.Tc(4,"Name"),c.cc(),c.ec(5,"td",Q),c.Tc(6,"URL"),c.cc(),c.Yb(7,"td",V),c.cc(),c.ec(8,"tbody"),c.Rc(9,et,10,2,"tr",L),c.cc(),c.cc(),c.cc()),2&t){var n=c.pc();c.Ic(9),c.vc("ngForOf",n.model.list)}}var ct=[1,"info-block"],it=[1,"text"];function ot(t,e){1&t&&(c.ec(0,"div",ct),c.ec(1,"div",it),c.Tc(2,"No authentication sources found"),c.cc(),c.cc())}var at=function(t){function e(e){var n=t.call(this)||this;return n.service=e,n.model={},n}return s.d(e,t),e.prototype.ngOnChanges=function(t){t.item&&this.load()},e.prototype.load=function(t){var e=this;void 0===t&&(t=0),this.service.AuthSources.query({authority_id:this.item.id,offset:t}).then(function(n){t||(e.model.list=[]);for(var c=0,i=n||[];c<i.length;c++){for(var o=i[c],a=!1,r=0,s=e.model.list;r<s.length;r++)if(s[r].id===o.id){a=!0;break}a||e.model.list.push(o)}},function(){return null})},e.ngComponentDef=c.Rb({type:e,selectors:[["domain-authentication"]],factory:function(t){return new(t||e)(c.Xb(d.a))},inputs:{item:"item"},features:[c.Fb,c.Gb()],consts:7,vars:2,template:function(t,e){1&t&&(c.ec(0,"div",q),c.ec(1,"section",H),c.ec(2,"button",W),c.Tc(3,"Add new"),c.cc(),c.cc(),c.ec(4,"section"),c.Rc(5,nt,10,1,"div",$),c.Rc(6,ot,3,0,"div",B),c.cc(),c.cc()),2&t&&(c.Ic(5),c.vc("ngIf",e.model.list&&e.model.list.length>0),c.Ic(6),c.vc("ngIf",!e.model.list||e.model.list.length<=0))},directives:[_.b,i.n,i.m],styles:[".container[_ngcontent-%COMP%]{padding:1em}.options[_ngcontent-%COMP%]{display:flex;font-size:1.2em;max-width:5em;margin:0}.action[_ngcontent-%COMP%]{height:1.5em;width:1.5em;min-width:1.5em;border-radius:.65em;display:flex;align-items:center;justify-content:center;font-size:1.3em}.action[_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.1)}.table-row[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{width:8em;min-width:8em}.state[_ngcontent-%COMP%]{height:1.5em;width:1.5em;margin:.25em;background-color:#000;border-radius:.8em;transition:margin 250ms,height 250ms,width 250ms,background-color .3s}.state.active[_ngcontent-%COMP%]{background-color:#4caf50;height:.75em;width:.75em;margin:.625em}.select[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}section[_ngcontent-%COMP%]{padding:.5em .25em}"]}),e}(b.a),rt=[1,"container"],st=["class","list",4,"ngIf"],lt=["class","info-block",4,"ngIf"],dt=[1,"list"],mt=[1,"name"],ut=[1,"flex"],ht=[1,"role"],pt=[4,"ngFor","ngForOf"];function ft(t,e){if(1&t&&(c.ec(0,"tr"),c.ec(1,"td",mt),c.Tc(2),c.cc(),c.ec(3,"td",ut),c.Tc(4),c.cc(),c.ec(5,"td",ht),c.Tc(6),c.cc(),c.cc()),2&t){var n=e.$implicit;c.Ic(2),c.Uc(n.name),c.Ic(4),c.Uc(n.email),c.Ic(6),c.Uc(n.role)}}function gt(t,e){if(1&t&&(c.ec(0,"div",dt),c.ec(1,"table"),c.ec(2,"thead"),c.ec(3,"td",mt),c.Tc(4,"Name"),c.cc(),c.ec(5,"td",ut),c.Tc(6,"Email"),c.cc(),c.ec(7,"td",ht),c.Tc(8,"Role"),c.cc(),c.cc(),c.ec(9,"tbody"),c.Rc(10,ft,7,3,"tr",pt),c.cc(),c.cc(),c.cc()),2&t){var n=c.pc();c.Ic(10),c.vc("ngForOf",n.model.list)}}var vt=[1,"info-block"],bt=[1,"text"];function _t(t,e){1&t&&(c.ec(0,"div",vt),c.ec(1,"div",bt),c.Tc(2,"No users found"),c.cc(),c.cc())}var wt=function(t){function e(e){var n=t.call(this)||this;return n.service=e,n.model={},n}return s.d(e,t),e.prototype.ngOnInit=function(){this.load()},e.prototype.ngOnChanges=function(t){t.item&&this.load()},e.prototype.load=function(t){var e=this;void 0===t&&(t=0),this.service.Users.query({authority_id:this.item.id,offset:t}).then(function(n){t||(e.model.list=[]);for(var c=0,i=n||[];c<i.length;c++){for(var o=i[c],a=!1,r=0,s=e.model.list;r<s.length;r++)if(s[r].id===o.id){a=!0;break}a||e.model.list.push(o)}},function(){return null})},e.ngComponentDef=c.Rb({type:e,selectors:[["domain-users"]],factory:function(t){return new(t||e)(c.Xb(d.a))},inputs:{item:"item"},features:[c.Fb,c.Gb()],consts:4,vars:2,template:function(t,e){1&t&&(c.ec(0,"div",rt),c.ec(1,"section"),c.Rc(2,gt,11,1,"div",st),c.Rc(3,_t,3,0,"div",lt),c.cc(),c.cc()),2&t&&(c.Ic(2),c.vc("ngIf",e.model.list&&e.model.list.length>0),c.Ic(3),c.vc("ngIf",!e.model.list||e.model.list.length<=0))},directives:[i.n,i.m],styles:[".container[_ngcontent-%COMP%]{padding:1em}.options[_ngcontent-%COMP%]{display:flex;font-size:1.2em;max-width:5em;margin:0}.action[_ngcontent-%COMP%]{height:1.5em;width:1.5em;min-width:1.5em;border-radius:.65em;display:flex;align-items:center;justify-content:center;font-size:1.3em}.action[_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.1)}.table-row[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{width:12em;min-width:12em}.table-row[_ngcontent-%COMP%]   .role[_ngcontent-%COMP%]{width:8em;min-width:8em}.state[_ngcontent-%COMP%]{height:1.5em;width:1.5em;margin:.25em;background-color:#000;border-radius:.8em;transition:margin 250ms,height 250ms,width 250ms,background-color .3s}.state.active[_ngcontent-%COMP%]{background-color:#4caf50;height:.75em;width:.75em;margin:.625em}.select[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}section[_ngcontent-%COMP%]{padding:.5em .25em}"]}),e}(b.a),yt=[1,"container"],Ct=[1,"sidebar"],Ot=["heading","Domains",3,"module","close","searchChange","event"],Mt=[3,"touchrelease"],Pt=["name","zone",3,"item","active","tabs","event"],It=["apps",""],kt=["auth",""],xt=["users",""],At=[3,"item"];function Tt(t,e){if(1&t&&c.Yb(0,"domain-applications",At),2&t){var n=c.pc();c.vc("item",n.item)}}function Rt(t,e){if(1&t&&c.Yb(0,"domain-authentication",At),2&t){var n=c.pc();c.vc("item",n.item)}}function Dt(t,e){if(1&t&&c.Yb(0,"domain-users",At),2&t){var n=c.pc();c.vc("item",n.item)}}var Ut={class:"backoffice-publish"},Ft=function(t,e){return{id:"applications",name:"Applications",count:t,template:e,icon:Ut}},St={class:"backoffice-lock-open"},Et=function(t,e){return{id:"authentication",name:"Authentication",count:t,template:e,icon:St}},Yt={class:"backoffice-users"},Nt=function(t,e){return{id:"users",name:"Users",count:t,template:e,icon:Yt}},Xt=function(t,e,n){return[t,e,n]},jt=function(t){function e(e,n,c,i){var o=t.call(this,e,n,c)||this;return o._service=e,o._route=n,o._router=c,o._dialog=i,o.service=o._service.Domains,o}return s.d(e,t),e.prototype.loadValues=function(){var t=this,e={offset:0,limit:1,owner:this.item.id};this._service.Applications.query(e).then(function(){return t.applications=t._service.Applications.last_total}),this._service.AuthSources.query(e={offset:0,limit:1,authority_id:this.item.id}).then(function(){return t.auth_sources=t._service.AuthSources.last_total}),this._service.Users.query(e).then(function(){return t.user_count=t._service.Users.last_total})},e.prototype.new=function(){this._dialog.open(u.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:new l.e(this._service.Domains,{}),service:this._service.Domains}})},e.prototype.edit=function(){this.item&&this._dialog.open(u.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:this.item,service:this._service.Domains}})},e.prototype.delete=function(){var t=this;if(this.item){var e=this._dialog.open(h.b,s.a({},h.a,{data:{title:"Delete domain",content:"<p>Are you sure you want delete this domain?</p><p>The domain will be deleted <strong>immediately.</strong></p>",icon:{type:"icon",class:"backoffice-trash"}}}));this.subscription("delete_confirm",e.componentInstance.event.subscribe(function(n){"done"===n.reason&&(e.componentInstance.loading="Deleting domain...",t.item.delete().then(function(){t._service.notifySuccess('Successfully deleted domain "'+t.item.name+'".'),t._router.navigate(["/users"]),e.close(),t.unsub("delete_confirm")},function(n){e.componentInstance.loading=null,t._service.notifyError("Error deleting domain. Error: "+n)}))}))}},e.ngComponentDef=c.Rb({type:e,selectors:[["app-domains"]],factory:function(t){return new(t||e)(c.Xb(d.a),c.Xb(a.a),c.Xb(a.c),c.Xb(p.b))},features:[c.Fb],consts:11,vars:19,template:function(t,e){if(1&t&&(c.ec(0,"div",yt),c.Pc(),c.ec(1,"div",Ct),c.ec(2,"sidebar",Ot),c.kc("searchChange",function(t){return e.search(t)}),c.kc("event",function(t){return e.sidebarEvent(t)}),c.cc(),c.cc(),c.ec(3,"main",Mt),c.kc("touchrelease",function(t){return e.show_sidebar=!1}),c.ec(4,"item-display",Pt),c.kc("event",function(t){return e.itemEvent(t)}),c.Rc(5,Tt,1,1,"ng-template",null,It,c.Sc),c.Rc(7,Rt,1,1,"ng-template",null,kt,c.Sc),c.Rc(9,Dt,1,1,"ng-template",null,xt,c.Sc),c.cc(),c.cc(),c.cc()),2&t){var n=c.Bc(6),i=c.Bc(8),o=c.Bc(10);c.Mb("show",e.show_sidebar),c.Qc(),c.Ic(2),c.vc("module",e.module)("close",e.show_sidebar),c.Ic(4),c.vc("item",e.item)("active",e.tab)("tabs",c.yc(15,Xt,c.xc(6,Ft,e.applications||0,n),c.xc(9,Et,e.auth_sources||0,i),c.xc(12,Nt,e.user_count||0,o)))}},directives:[f.a,g.b,v.a,z,at,wt],styles:[".container[_ngcontent-%COMP%]{display:flex;align-items:center;height:100%;width:100%}.sidebar[_ngcontent-%COMP%]{height:100%;width:20em}@media only screen and (orientation:portrait) and (max-width:450px){.container[_ngcontent-%COMP%]{flex-direction:column}.container.show[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{height:100%}.container.show[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{height:0%}.sidebar[_ngcontent-%COMP%]{height:3em;min-height:3em;width:100%;transition:height .3s}main[_ngcontent-%COMP%]{transition:height .3s;width:100%}}@media only screen and (orientation:landscape) and (max-width:800px){.container[_ngcontent-%COMP%]{flex-direction:column}.container.show[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{height:100%}.container.show[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{height:0%}.sidebar[_ngcontent-%COMP%]{height:3em;min-height:3em;width:100%;transition:height .3s}main[_ngcontent-%COMP%]{transition:height .3s;width:100%}}main[_ngcontent-%COMP%]{position:relative;height:100%;overflow:hidden;flex:1;background-color:#f0f0f0}"]}),e}(m.a),zt=[{path:"",component:jt,children:[]},{path:":id",component:jt,children:[]},{path:"**",redirectTo:""}],qt=n("PCNd");n.d(e,"AppDomainsModule",function(){return Ht});var Ht=function(){function t(){}return t.ngModuleDef=c.Vb({type:t}),t.ngInjectorDef=c.Ub({factory:function(e){return new(e||t)},imports:[[i.c,o.g,r.b,a.g.forChild(zt),qt.a]]}),t}();a.g.forChild(zt)}}]);