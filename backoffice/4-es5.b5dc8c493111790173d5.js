(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{jtLk:function(e,t,n){"use strict";n.r(t);var i=n("TYT/"),c=n("Valr"),s=n("QJY3"),o=n("DUip"),r=n("pS6y"),a=n("mrSG"),d=n("UN3I"),l=n("OaWH"),u=n("C/ya"),h=n("D/9M"),m=n("g+Po"),g=n("QrbZ"),f=n("BAfr"),p=n("xtoW"),v=n("ZwpQ"),y=n("47y3"),_=n("5f3J"),b=n("YxBP"),M=n("2mMm"),C=n("rUqb"),w=[1,"container"],O=[1,"settings"],P=["mat-button",""],x=[3,"touchrelease"],I=[3,"ngModel","readonly"],S=function(e){function t(t){var n=e.call(this)||this;return n._service=t,n}return a.d(t,e),t.prototype.ngOnChanges=function(e){e.item&&(this.loadDependency(),this.loadSystem())},t.prototype.loadDependency=function(){var e=this;this.item&&this.item.dependency_id&&this._service.Drivers.show(this.item.dependency_id).then(function(t){e.dependency=t,e.updateSettings()})},t.prototype.loadSystem=function(){var e=this;this.item&&this.item.system_id&&this._service.Systems.show(this.item.system_id).then(function(t){e.system=t,e.updateSettings()})},t.prototype.toggleSettings=function(){this.merged=!1===this.merged,this.updateSettings()},t.prototype.updateSettings=function(){this.item&&(!1!==this.merged?(this.settings=Object(b.b)("",this.item.settings.settings_string||""),this.dependency&&(this.settings=Object(b.b)(this.settings,this.dependency.settings.settings_string||""))):this.settings=this.item.settings.settings_string||"")},t.ngComponentDef=i.Rb({type:t,selectors:[["device-about"]],factory:function(e){return new(e||t)(i.Xb(l.a))},inputs:{item:"item"},features:[i.Fb,i.Gb()],consts:15,vars:4,template:function(e,t){1&e&&(i.ec(0,"div",w),i.ec(1,"div",O),i.ec(2,"header"),i.Tc(3,"Logic for system:\xa0"),i.ec(4,"span"),i.Tc(5),i.cc(),i.cc(),i.ec(6,"section"),i.ec(7,"button",P),i.Tc(8,"Stop Device"),i.cc(),i.cc(),i.ec(9,"header"),i.Tc(10,"Settings "),i.ec(11,"span",x),i.kc("touchrelease",function(e){return t.toggleSettings()}),i.Tc(12),i.cc(),i.cc(),i.ec(13,"section"),i.Yb(14,"settings-form-field",I),i.cc(),i.cc(),i.cc()),2&e&&(i.Ic(5),i.Uc(null==t.system?null:t.system.name),i.Ic(12),i.Uc(!1===t.merged?"This module":"Merged"),i.Ic(14),i.vc("ngModel",t.settings)("readonly",!0))},directives:[M.b,v.b,C.a,s.k,s.n],styles:[".container[_ngcontent-%COMP%]{padding:1em}header[_ngcontent-%COMP%]{display:flex;align-items:center;font-weight:700;font-size:1.1em}header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.7em;color:rgba(0,0,0,.6);padding:0 1em;font-weight:300;text-decoration:underline;cursor:pointer;transition:color .2s}header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:hover{color:rgba(0,0,0,.85)}section[_ngcontent-%COMP%]{padding:.5em .25em}"]}),t}(_.a),k=n("K9Ia"),T=n("F/XL"),D=n("Gi3i"),j=n("ad02"),F=n("15JJ"),L=n("9Z1F"),U=n("67Y/"),Y=n("FgbW"),R=n("0njA"),q=n("M+/Y"),E=[1,"container"],X=[1,"btn"],A=["appearance","outline"],J=["matPrefix","",1,"prefix"],$=[3,"icon"],B=["matInput","","name","search-filter","placeholder","Filter Systems",3,"ngModel","ngModelChange"],N=["class","list",4,"ngIf","ngIfElse"],W=["empty_state",""],G=[1,"list"],Q=[1,"flex"],V=[1,"devices"],z=[1,"created"],H=[4,"ngFor","ngForOf"],Z=["routerLinkActive","router-link-active",3,"routerLink"],K=[1,"id"],ee=function(e){return["/systems",e]};function te(e,t){if(1&e&&(i.ec(0,"tr"),i.ec(1,"td",Q),i.ec(2,"a",Z),i.Tc(3),i.ec(4,"span",K),i.Tc(5),i.cc(),i.Tc(6,") "),i.cc(),i.cc(),i.ec(7,"td",V),i.Tc(8),i.cc(),i.ec(9,"td",z),i.Tc(10),i.cc(),i.cc()),2&e){var n=t.$implicit;i.Ic(2),i.vc("routerLink",i.wc(5,ee,n.id)),i.Ic(3),i.Vc(" ",n.name," ("),i.Ic(5),i.Uc(n.id),i.Ic(8),i.Uc(n.installed_ui_devices),i.Ic(10),i.Uc(null==n.display?null:n.display.created)}}function ne(e,t){if(1&e&&(i.ec(0,"div",G),i.ec(1,"table"),i.ec(2,"thead"),i.ec(3,"td",Q),i.Tc(4,"Name"),i.cc(),i.ec(5,"td",V),i.Tc(6,"No. Devices"),i.cc(),i.ec(7,"td",z),i.Tc(8,"Created"),i.cc(),i.cc(),i.ec(9,"tbody"),i.Rc(10,te,11,7,"tr",H),i.cc(),i.cc(),i.cc()),2&e){var n=i.pc();i.Ic(10),i.vc("ngForOf",n.system_list)}}var ie=[1,"info-block"],ce=[1,"text"];function se(e,t){1&e&&(i.ec(0,"div",ie),i.ec(1,"div",ce),i.Tc(2,"No matching systems found"),i.cc(),i.cc())}var oe={class:"backoffice-magnifying-glass"},re=function(e){function t(t){var n=e.call(this)||this;return n.service=t,n.search$=new k.a,n}return a.d(t,e),t.prototype.ngOnInit=function(){var e=this;this.search_results$=this.search$.pipe(Object(D.a)(400),Object(j.a)(),Object(F.a)(function(t){return e.loading=!0,e.service.Systems.query({q:t,module_id:e.item.id,offset:0})}),Object(L.a)(function(e){return console.error(e),Object(T.a)([])}),Object(U.a)(function(t){e.loading=!1;var n=e.search_str.toLowerCase();return t.filter(function(e){return e.name.toLowerCase().indexOf(n)>=0||(e.email||"").toLowerCase().indexOf(n)>=0})})),this.subscription("search_results",this.search_results$.subscribe(function(t){return e.system_list=t}))},t.prototype.ngOnChanges=function(e){e.item&&this.loadSystems()},t.prototype.loadSystems=function(e){var t=this;void 0===e&&(e=0),this.service.Systems.query({module_id:this.item.id,offset:e}).then(function(e){t.system_list=e},function(){return null})},t.ngComponentDef=i.Rb({type:t,selectors:[["device-systems"]],factory:function(e){return new(e||t)(i.Xb(l.a))},inputs:{item:"item"},features:[i.Fb,i.Gb()],consts:9,vars:4,template:function(e,t){if(1&e&&(i.ec(0,"div",E),i.ec(1,"div",X),i.ec(2,"mat-form-field",A),i.ec(3,"div",J),i.Yb(4,"app-icon",$),i.cc(),i.ec(5,"input",B),i.kc("ngModelChange",function(e){return t.search_str=e}),i.kc("ngModelChange",function(e){return t.search$.next(e)}),i.cc(),i.cc(),i.cc(),i.Rc(6,ne,11,1,"div",N),i.cc(),i.Rc(7,se,3,0,"ng-template",null,W,i.Sc)),2&e){var n=i.Bc(8);i.Ic(4),i.vc("icon",oe),i.Ic(5),i.vc("ngModel",t.search_str),i.Ic(6),i.vc("ngIf",t.system_list&&t.system_list.length>0)("ngIfElse",n)}},directives:[Y.b,Y.e,R.a,q.a,s.b,s.k,s.n,c.n,c.m,o.f,o.e],styles:[".container[_ngcontent-%COMP%]{padding:1em}mat-form-field[_ngcontent-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:1.25em}.list[_ngcontent-%COMP%]{margin-top:.5em}.table-row[_ngcontent-%COMP%]   .created[_ngcontent-%COMP%], .table-row[_ngcontent-%COMP%]   .devices[_ngcontent-%COMP%]{width:8em;min-width:8em}"]}),t}(_.a),ae=[1,"container"],de=[1,"sidebar"],le=["heading","Devices",3,"module","close","queryParams","searchChange","event"],ue=[1,"toggle"],he=["labelPosition","before",3,"ngModel","ngModelChange"],me=[3,"touchrelease"],ge=["name","device",3,"item","active","tabs","event"],fe=["about",""],pe=["systems",""],ve=[3,"item"];function ye(e,t){if(1&e&&i.Yb(0,"device-about",ve),2&e){var n=i.pc();i.vc("item",n.item)}}function _e(e,t){if(1&e&&i.Yb(0,"device-systems",ve),2&e){var n=i.pc();i.vc("item",n.item)}}var be={connected:!1,running:!0},Me={},Ce={class:"backoffice-info-with-circle"},we=function(e){return{id:"about",name:"About",template:e,icon:Ce}},Oe={class:"backoffice-documents"},Pe=function(e,t){return{id:"systems",name:"Systems",template:e,count:t,icon:Oe}},xe=function(e,t){return[e,t]},Ie=function(e){function t(t,n,i,c){var s=e.call(this,t,n,i)||this;return s._service=t,s._route=n,s._router=i,s._dialog=c,s.service=s._service.Modules,s}return a.d(t,e),t.prototype.loadValues=function(){var e=this;this._service.Systems.query({offset:0,limit:1,module_id:this.item.id}).then(function(){e.system_count=e._service.Systems.last_total})},t.prototype.new=function(){this._dialog.open(h.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:new d.h(this._service.Modules,{}),service:this._service.Modules}})},t.prototype.edit=function(){this.item&&this._dialog.open(h.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:this.item,service:this._service.Modules}})},t.prototype.delete=function(){var e=this;if(this.item){var t=this._dialog.open(m.b,a.a({},m.a,{data:{title:"Delete device",content:"<p>Are you sure you want delete this device?</p><p>Deleting this will device <strong>immediately</strong> remove it from any system associated with it</p>",icon:{type:"icon",class:"backoffice-trash"}}}));this.subscription("delete_confirm",t.componentInstance.event.subscribe(function(n){"done"===n.reason&&(t.componentInstance.loading="Deleting device...",e.item.delete().then(function(){e._service.notifySuccess('Successfully deleted device "'+e.item.name+'".'),e._router.navigate(["/modules"]),t.close(),e.unsub("delete_confirm")},function(n){t.componentInstance.loading=null,e._service.notifyError("Error deleting device. Error: "+n)}))}))}},t.ngComponentDef=i.Rb({type:t,selectors:[["app-devices"]],factory:function(e){return new(e||t)(i.Xb(l.a),i.Xb(o.a),i.Xb(o.c),i.Xb(g.b))},features:[i.Fb],consts:12,vars:16,template:function(e,t){if(1&e&&(i.ec(0,"div",ae),i.Pc(),i.ec(1,"div",de),i.ec(2,"sidebar",le),i.kc("searchChange",function(e){return t.search(e)}),i.kc("event",function(e){return t.sidebarEvent(e)}),i.ec(3,"div",ue),i.ec(4,"mat-slide-toggle",he),i.kc("ngModelChange",function(e){return t.only_disconnected=e}),i.Tc(5," Only Disconnected "),i.cc(),i.cc(),i.cc(),i.cc(),i.ec(6,"main",me),i.kc("touchrelease",function(e){return t.show_sidebar=!1}),i.ec(7,"item-display",ge),i.kc("event",function(e){return t.itemEvent(e)}),i.Rc(8,ye,1,1,"ng-template",null,fe,i.Sc),i.Rc(10,_e,1,1,"ng-template",null,pe,i.Sc),i.cc(),i.cc(),i.cc()),2&e){var n=i.Bc(9),c=i.Bc(11);i.Mb("show",t.show_sidebar),i.Qc(),i.Ic(2),i.vc("module",t.module)("close",t.show_sidebar)("queryParams",t.only_disconnected?be:Me),i.Ic(4),i.vc("ngModel",t.only_disconnected),i.Ic(7),i.vc("item",t.item)("active",t.tab)("tabs",i.xc(13,xe,i.wc(8,we,n),i.xc(10,Pe,c,t.system_count)))}},directives:[f.a,p.a,s.k,s.n,v.b,y.a,S,re],styles:[".container[_ngcontent-%COMP%]{display:flex;align-items:center;height:100%;width:100%}.sidebar[_ngcontent-%COMP%]{height:100%;width:20em}@media only screen and (orientation:portrait) and (max-width:450px){.container[_ngcontent-%COMP%]{flex-direction:column}.container.show[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{height:100%}.container.show[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{height:0%}.sidebar[_ngcontent-%COMP%]{height:3em;min-height:3em;width:100%;transition:height .3s}main[_ngcontent-%COMP%]{transition:height .3s;width:100%}}@media only screen and (orientation:landscape) and (max-width:800px){.container[_ngcontent-%COMP%]{flex-direction:column}.container.show[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{height:100%}.container.show[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{height:0%}.sidebar[_ngcontent-%COMP%]{height:3em;min-height:3em;width:100%;transition:height .3s}main[_ngcontent-%COMP%]{transition:height .3s;width:100%}}main[_ngcontent-%COMP%]{position:relative;height:100%;overflow:hidden;flex:1;background-color:#f0f0f0}.toggle[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;padding-right:1em}"]}),t}(u.a),Se=[{path:"",component:Ie,children:[]},{path:":id",component:Ie,children:[]},{path:"**",redirectTo:""}],ke=n("PCNd");n.d(t,"AppDevicesModule",function(){return Te});var Te=function(){function e(){}return e.ngModuleDef=i.Vb({type:e}),e.ngInjectorDef=i.Ub({factory:function(t){return new(t||e)},imports:[[c.c,s.g,r.b,o.g.forChild(Se),ke.a]]}),e}();o.g.forChild(Se)}}]);