(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{aCzL:function(t,e,c){"use strict";c.r(e);var n=c("fXoL"),i=c("ofXK"),o=c("3Pt+"),s=c("tyNb"),a=c("CcG0"),r=c("UN3I"),d=c("OaWH"),l=c("C/ya"),h=c("D/9M"),u=c("g+Po"),m=c("LcAk"),p=c("BAfr"),g=c("m6yr"),f=c("47y3"),b=c("5f3J"),_=c("Xlwt"),v=c("0njA");const w=[1,"container"],y=[1,"select"],C=["mat-button","",3,"tapped"],O=["class","list",4,"ngIf"],M=["class","info-block",4,"ngIf"],P=[1,"list"],I=[1,"name"],A=[1,"flex"],k=[1,"scope"],x=[1,"duo"],S=[4,"ngFor","ngForOf"],T=["mat-icon-button","",3,"tapped"],D=[3,"icon"],E={class:"backoffice-edit"},R={class:"backoffice-trash"};function U(t,e){if(1&t){const t=n.fc();n.ec(0,"tr"),n.ec(1,"td",I),n.Tc(2),n.cc(),n.ec(3,"td",A),n.Tc(4),n.cc(),n.ec(5,"td",k),n.Tc(6),n.cc(),n.ec(7,"td",x),n.ec(8,"button",T),n.kc("tapped",function(c){n.Ec(t);const i=e.$implicit;return n.pc(2).editApplication(i)}),n.Yb(9,"app-icon",D),n.cc(),n.ec(10,"button",T),n.kc("tapped",function(c){n.Ec(t);const i=e.$implicit;return n.pc(2).deleteApplication(i)}),n.Yb(11,"app-icon",D),n.cc(),n.cc(),n.cc()}if(2&t){const t=e.$implicit;n.Ic(2),n.Uc(t.name),n.Ic(4),n.Uc(t.redirect),n.Ic(6),n.Uc(t.scope),n.Ic(9),n.vc("icon",E),n.Ic(11),n.vc("icon",R)}}function F(t,e){if(1&t&&(n.ec(0,"div",P),n.ec(1,"table"),n.ec(2,"thead"),n.ec(3,"td",I),n.Tc(4,"Name"),n.cc(),n.ec(5,"td",A),n.Tc(6,"Redirect"),n.cc(),n.ec(7,"td",k),n.Tc(8,"Scope"),n.cc(),n.Yb(9,"td",x),n.cc(),n.ec(10,"tbody"),n.Rc(11,U,12,5,"tr",S),n.cc(),n.cc(),n.cc()),2&t){const t=n.pc();n.Ic(11),n.vc("ngForOf",t.application_list)}}const $=[1,"info-block"],X=[1,"text"];function j(t,e){1&t&&(n.ec(0,"div",$),n.ec(1,"div",X),n.Tc(2,"No applications found"),n.cc(),n.cc())}const N=(()=>{class t extends b.a{constructor(t,e){super(),this._service=t,this._dialog=e}ngOnChanges(t){t.item&&this.loadApplications()}loadApplications(t=0){this._service.Applications.query({owner:this.item.id,offset:t}).then(e=>{t||(this.application_list=[]);for(const t of e||[]){let e=!1;for(const c of this.application_list)if(c.id===t.id){e=!0;break}e||this.application_list.push(t)}},()=>null)}newApplication(){this._dialog.open(h.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:new r.c(this._service.Applications,{}),service:this._service.Applications}})}editApplication(t){this.item&&this._dialog.open(h.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:t,service:this._service.Applications}})}deleteApplication(t){if(t){const e=this._dialog.open(u.b,Object.assign({},u.a,{data:{title:"Delete application",content:`<p>Are you sure you want delete the application ${t.name}?</p><p>Configuration will be <strong>immediately</strong> updated</p>`,icon:{type:"icon",class:"backoffice-trash"}}}));this.subscription("delete_confirm",e.componentInstance.event.subscribe(c=>{"done"===c.reason&&(e.componentInstance.loading="Deleting application...",t.delete().then(()=>{this._service.notifySuccess(`Successfully deleted application "${t.name}".`),this.loadApplications(),e.close(),this.unsub("delete_confirm")},t=>{e.componentInstance.loading=null,this._service.notifyError(`Error deleting application. Error: ${t}`)}))}))}}}return t.ngComponentDef=n.Rb({type:t,selectors:[["domain-applications"]],factory:function(e){return new(e||t)(n.Xb(d.a),n.Xb(m.b))},inputs:{item:"item"},features:[n.Fb,n.Gb()],consts:7,vars:2,template:function(t,e){1&t&&(n.ec(0,"div",w),n.ec(1,"section",y),n.ec(2,"button",C),n.kc("tapped",function(t){return e.newApplication()}),n.Tc(3,"Add new"),n.cc(),n.cc(),n.ec(4,"section"),n.Rc(5,F,12,1,"div",O),n.Rc(6,j,3,0,"div",M),n.cc(),n.cc()),2&t&&(n.Ic(5),n.vc("ngIf",e.application_list&&e.application_list.length>0),n.Ic(6),n.vc("ngIf",!e.application_list||e.application_list.length<=0))},directives:[_.b,g.b,i.n,i.m,v.a],styles:[".container[_ngcontent-%COMP%]{padding:1em}.options[_ngcontent-%COMP%]{display:flex;font-size:1.2em;max-width:5em;margin:0}.state[_ngcontent-%COMP%]{height:1.5em;width:1.5em;margin:.25em;background-color:#000;border-radius:.8em;transition:margin 250ms,height 250ms,width 250ms,background-color .3s}.state.active[_ngcontent-%COMP%]{background-color:#4caf50;height:.75em;width:.75em;margin:.625em}.duo[_ngcontent-%COMP%]{width:6em}.table-row[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%], .table-row[_ngcontent-%COMP%]   .scope[_ngcontent-%COMP%]{width:8em;min-width:8em}.select[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}section[_ngcontent-%COMP%]{padding:.5em .25em}"]}),t})();var Y=c("dQMc");const q=[1,"container"],z=[1,"select"],L=["mat-button","",3,"tapped"],B=["class","list",4,"ngIf","ngIfElse"],H=["no_auth_sources",""],W=[1,"list"],G=[1,"name"],J=[1,"flex"],Q=[1,"duo"],V=[4,"ngFor","ngForOf"],K=["mat-icon-button","",3,"tapped"],Z=[3,"icon"],tt={class:"backoffice-edit"},et={class:"backoffice-trash"};function ct(t,e){if(1&t){const t=n.fc();n.ec(0,"tr"),n.ec(1,"td",G),n.Tc(2),n.cc(),n.ec(3,"td",J),n.Tc(4),n.cc(),n.ec(5,"td",Q),n.ec(6,"button",K),n.kc("tapped",function(c){n.Ec(t);const i=e.$implicit;return n.pc(2).editAuthSource(i)}),n.Yb(7,"app-icon",Z),n.cc(),n.ec(8,"button",K),n.kc("tapped",function(c){n.Ec(t);const i=e.$implicit;return n.pc(2).deleteAuthSource(i)}),n.Yb(9,"app-icon",Z),n.cc(),n.cc(),n.cc()}if(2&t){const t=e.$implicit,c=n.pc(2);n.Ic(2),n.Uc(t.name),n.Ic(4),n.Uc(c.source_types[t.id]),n.Ic(7),n.vc("icon",tt),n.Ic(9),n.vc("icon",et)}}function nt(t,e){if(1&t&&(n.ec(0,"div",W),n.ec(1,"table"),n.ec(2,"thead"),n.ec(3,"td",G),n.Tc(4,"Name"),n.cc(),n.ec(5,"td",J),n.Tc(6,"Type"),n.cc(),n.Yb(7,"td",Q),n.cc(),n.ec(8,"tbody"),n.Rc(9,ct,10,4,"tr",V),n.cc(),n.cc(),n.cc()),2&t){const t=n.pc();n.Ic(9),n.vc("ngForOf",t.auth_sources)}}const it=[1,"info-block"],ot=[1,"text"];function st(t,e){1&t&&(n.ec(0,"div",it),n.ec(1,"div",ot),n.Tc(2,"No authentication sources found"),n.cc(),n.cc())}const at=(()=>{class t extends b.a{constructor(t,e){super(),this._service=t,this._dialog=e,this.auth_sources=[],this.source_types={}}ngOnChanges(t){t.item&&this.loadAuthSources()}loadAuthSources(t=0){Promise.all([this._service.OAuthSources.query({authority_id:this.item.id,offset:t}),this._service.SAMLAuthSources.query({authority_id:this.item.id,offset:t}),this._service.LDAPAuthSources.query({authority_id:this.item.id,offset:t})]).then(e=>{t||(this.auth_sources=[]);for(const t of e)t.forEach(t=>this.addAuthSourceToList(t))},()=>null)}newAuthSource(){this._dialog.open(Y.a,{width:"auto",height:"auto",data:{domain:this.item}}).afterClosed().subscribe(()=>this.loadAuthSources())}editAuthSource(t){this._dialog.open(Y.a,{width:"auto",height:"auto",data:{domain:this.item,auth_source:t}}).afterClosed().subscribe(()=>this.loadAuthSources())}deleteAuthSource(t){if(t){const e=this._dialog.open(u.b,Object.assign({},u.a,{data:{title:"Delete auth source",content:"<p>Are you sure you want delete this auth source?</p><p>Deleting this will device <strong>immediately</strong> remove it from any system associated with it</p>",icon:{type:"icon",class:"backoffice-trash"}}}));this.subscription("delete_confirm",e.componentInstance.event.subscribe(c=>{"done"===c.reason&&(e.componentInstance.loading="Deleting auth source...",t.delete().then(()=>{this._service.notifySuccess("Successfully deleted auth source."),e.close(),this.unsub("delete_confirm"),this.loadAuthSources()},t=>{this._service.notifyError(`Error deleting auth source. Error ${t.message||t}`),e.componentInstance.loading=null}))}))}}addAuthSourceToList(t){this.source_types[t.id]=t instanceof r.l?"saml":t instanceof r.g?"ldap":"oauth";const e=this.auth_sources.findIndex(e=>e.id===t.id);e<0?this.auth_sources.push(t):this.auth_sources.splice(e,1,t)}}return t.ngComponentDef=n.Rb({type:t,selectors:[["domain-authentication"]],factory:function(e){return new(e||t)(n.Xb(d.a),n.Xb(m.b))},inputs:{item:"item"},features:[n.Fb,n.Gb()],consts:8,vars:2,template:function(t,e){if(1&t&&(n.ec(0,"div",q),n.ec(1,"section",z),n.ec(2,"button",L),n.kc("tapped",function(t){return e.newAuthSource()}),n.Tc(3,"Add new"),n.cc(),n.cc(),n.ec(4,"section"),n.Rc(5,nt,10,1,"div",B),n.cc(),n.cc(),n.Rc(6,st,3,0,"ng-template",null,H,n.Sc)),2&t){const t=n.Bc(7);n.Ic(5),n.vc("ngIf",e.auth_sources&&e.auth_sources.length>0)("ngIfElse",t)}},directives:[_.b,g.b,i.n,i.m,v.a],styles:[".container[_ngcontent-%COMP%]{padding:1em}.options[_ngcontent-%COMP%]{display:flex;font-size:1.2em;max-width:5em;margin:0}.action[_ngcontent-%COMP%]{height:1.5em;width:1.5em;min-width:1.5em;border-radius:.65em;display:flex;align-items:center;justify-content:center;font-size:1.3em}.action[_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.1)}.table-row[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{width:8em;min-width:8em}.state[_ngcontent-%COMP%]{height:1.5em;width:1.5em;margin:.25em;background-color:#000;border-radius:.8em;transition:margin 250ms,height 250ms,width 250ms,background-color .3s}.state.active[_ngcontent-%COMP%]{background-color:#4caf50;height:.75em;width:.75em;margin:.625em}.select[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}section[_ngcontent-%COMP%]{padding:.5em .25em}.duo[_ngcontent-%COMP%]{width:6em;text-align:right}"]}),t})(),rt=[1,"container"],dt=["class","list",4,"ngIf"],lt=["class","info-block",4,"ngIf"],ht=[1,"list"],ut=[1,"name"],mt=[1,"flex"],pt=[1,"role"],gt=[4,"ngFor","ngForOf"];function ft(t,e){if(1&t&&(n.ec(0,"tr"),n.ec(1,"td",ut),n.Tc(2),n.cc(),n.ec(3,"td",mt),n.Tc(4),n.cc(),n.ec(5,"td",pt),n.Tc(6),n.cc(),n.cc()),2&t){const t=e.$implicit;n.Ic(2),n.Uc(t.name),n.Ic(4),n.Uc(t.email),n.Ic(6),n.Uc(t.role)}}function bt(t,e){if(1&t&&(n.ec(0,"div",ht),n.ec(1,"table"),n.ec(2,"thead"),n.ec(3,"td",ut),n.Tc(4,"Name"),n.cc(),n.ec(5,"td",mt),n.Tc(6,"Email"),n.cc(),n.ec(7,"td",pt),n.Tc(8,"Role"),n.cc(),n.cc(),n.ec(9,"tbody"),n.Rc(10,ft,7,3,"tr",gt),n.cc(),n.cc(),n.cc()),2&t){const t=n.pc();n.Ic(10),n.vc("ngForOf",t.model.list)}}const _t=[1,"info-block"],vt=[1,"text"];function wt(t,e){1&t&&(n.ec(0,"div",_t),n.ec(1,"div",vt),n.Tc(2,"No users found"),n.cc(),n.cc())}const yt=(()=>{class t extends b.a{constructor(t){super(),this.service=t,this.model={}}ngOnInit(){this.load()}ngOnChanges(t){t.item&&this.load()}load(t=0){this.service.Users.query({authority_id:this.item.id,offset:t}).then(e=>{t||(this.model.list=[]);for(const t of e||[]){let e=!1;for(const c of this.model.list)if(c.id===t.id){e=!0;break}e||this.model.list.push(t)}},()=>null)}}return t.ngComponentDef=n.Rb({type:t,selectors:[["domain-users"]],factory:function(e){return new(e||t)(n.Xb(d.a))},inputs:{item:"item"},features:[n.Fb,n.Gb()],consts:4,vars:2,template:function(t,e){1&t&&(n.ec(0,"div",rt),n.ec(1,"section"),n.Rc(2,bt,11,1,"div",dt),n.Rc(3,wt,3,0,"div",lt),n.cc(),n.cc()),2&t&&(n.Ic(2),n.vc("ngIf",e.model.list&&e.model.list.length>0),n.Ic(3),n.vc("ngIf",!e.model.list||e.model.list.length<=0))},directives:[i.n,i.m],styles:[".container[_ngcontent-%COMP%]{padding:1em}.options[_ngcontent-%COMP%]{display:flex;font-size:1.2em;max-width:5em;margin:0}.action[_ngcontent-%COMP%]{height:1.5em;width:1.5em;min-width:1.5em;border-radius:.65em;display:flex;align-items:center;justify-content:center;font-size:1.3em}.action[_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.1)}.table-row[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{width:12em;min-width:12em}.table-row[_ngcontent-%COMP%]   .role[_ngcontent-%COMP%]{width:8em;min-width:8em}.state[_ngcontent-%COMP%]{height:1.5em;width:1.5em;margin:.25em;background-color:#000;border-radius:.8em;transition:margin 250ms,height 250ms,width 250ms,background-color .3s}.state.active[_ngcontent-%COMP%]{background-color:#4caf50;height:.75em;width:.75em;margin:.625em}.select[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}section[_ngcontent-%COMP%]{padding:.5em .25em}"]}),t})(),Ct=[1,"container"],Ot=[1,"sidebar"],Mt=["heading","Domains",3,"module","close","searchChange","event"],Pt=[3,"touchrelease"],It=["name","zone",3,"item","active","tabs","event"],At=["apps",""],kt=["auth",""],xt=["users",""],St=[3,"item"];function Tt(t,e){if(1&t&&n.Yb(0,"domain-applications",St),2&t){const t=n.pc();n.vc("item",t.item)}}function Dt(t,e){if(1&t&&n.Yb(0,"domain-authentication",St),2&t){const t=n.pc();n.vc("item",t.item)}}function Et(t,e){if(1&t&&n.Yb(0,"domain-users",St),2&t){const t=n.pc();n.vc("item",t.item)}}const Rt={class:"backoffice-publish"},Ut=function(t,e){return{id:"applications",name:"Applications",count:t,template:e,icon:Rt}},Ft={class:"backoffice-lock-open"},$t=function(t,e){return{id:"authentication",name:"Authentication",count:t,template:e,icon:Ft}},Xt={class:"backoffice-users"},jt=function(t,e){return{id:"users",name:"Users",count:t,template:e,icon:Xt}},Nt=function(t,e,c){return[t,e,c]},Yt=(()=>{class t extends l.a{constructor(t,e,c,n){super(t,e,c),this._service=t,this._route=e,this._router=c,this._dialog=n,this.service=this._service.Domains}loadValues(){let t={offset:0,limit:1,owner:this.item.id};this._service.Applications.query(t).then(()=>this.applications=this._service.Applications.last_total),this._service.Users.query(t={offset:0,limit:1,authority_id:this.item.id}).then(()=>this.user_count=this._service.Users.last_total)}new(){this._dialog.open(h.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:new r.e(this._service.Domains,{}),service:this._service.Domains}})}edit(){this.item&&this._dialog.open(h.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:this.item,service:this._service.Domains}})}delete(){if(this.item){const t=this._dialog.open(u.b,Object.assign({},u.a,{data:{title:"Delete domain",content:"<p>Are you sure you want delete this domain?</p><p>The domain will be deleted <strong>immediately.</strong></p>",icon:{type:"icon",class:"backoffice-trash"}}}));this.subscription("delete_confirm",t.componentInstance.event.subscribe(e=>{"done"===e.reason&&(t.componentInstance.loading="Deleting domain...",this.item.delete().then(()=>{this._service.notifySuccess(`Successfully deleted domain "${this.item.name}".`),this._router.navigate(["/users"]),t.close(),this.unsub("delete_confirm")},e=>{t.componentInstance.loading=null,this._service.notifyError(`Error deleting domain. Error: ${e}`)}))}))}}}return t.ngComponentDef=n.Rb({type:t,selectors:[["app-domains"]],factory:function(e){return new(e||t)(n.Xb(d.a),n.Xb(s.a),n.Xb(s.c),n.Xb(m.b))},features:[n.Fb],consts:11,vars:19,template:function(t,e){if(1&t&&(n.ec(0,"div",Ct),n.Pc(),n.ec(1,"div",Ot),n.ec(2,"sidebar",Mt),n.kc("searchChange",function(t){return e.search(t)}),n.kc("event",function(t){return e.sidebarEvent(t)}),n.cc(),n.cc(),n.ec(3,"main",Pt),n.kc("touchrelease",function(t){return e.show_sidebar=!1}),n.ec(4,"item-display",It),n.kc("event",function(t){return e.itemEvent(t)}),n.Rc(5,Tt,1,1,"ng-template",null,At,n.Sc),n.Rc(7,Dt,1,1,"ng-template",null,kt,n.Sc),n.Rc(9,Et,1,1,"ng-template",null,xt,n.Sc),n.cc(),n.cc(),n.cc()),2&t){const t=n.Bc(6),c=n.Bc(8),i=n.Bc(10);n.Mb("show",e.show_sidebar),n.Qc(),n.Ic(2),n.vc("module",e.module)("close",e.show_sidebar),n.Ic(4),n.vc("item",e.item)("active",e.tab)("tabs",n.yc(15,Nt,n.xc(6,Ut,e.applications||0,t),n.xc(9,$t,e.auth_sources||0,c),n.xc(12,jt,e.user_count||0,i)))}},directives:[p.a,g.b,f.a,N,at,yt],styles:[".container[_ngcontent-%COMP%]{display:flex;align-items:center;height:100%;width:100%}.sidebar[_ngcontent-%COMP%]{height:100%;width:20em}@media only screen and (orientation:portrait) and (max-width:450px){.container[_ngcontent-%COMP%]{flex-direction:column}.container.show[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{height:100%}.container.show[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{height:0%}.sidebar[_ngcontent-%COMP%]{height:3em;min-height:3em;width:100%;transition:height .3s}main[_ngcontent-%COMP%]{transition:height .3s;width:100%}}@media only screen and (orientation:landscape) and (max-width:800px){.container[_ngcontent-%COMP%]{flex-direction:column}.container.show[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{height:100%}.container.show[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{height:0%}.sidebar[_ngcontent-%COMP%]{height:3em;min-height:3em;width:100%;transition:height .3s}main[_ngcontent-%COMP%]{transition:height .3s;width:100%}}main[_ngcontent-%COMP%]{position:relative;height:100%;overflow:hidden;flex:1;background-color:#f0f0f0}"]}),t})(),qt=[{path:"",component:Yt,children:[]},{path:":id",component:Yt,children:[]},{path:"**",redirectTo:""}];var zt=c("PCNd");c.d(e,"AppDomainsModule",function(){return Lt});const Lt=(()=>{class t{}return t.ngModuleDef=n.Vb({type:t}),t.ngInjectorDef=n.Ub({factory:function(e){return new(e||t)},imports:[[i.c,o.g,a.b,s.g.forChild(qt),zt.a]]}),t})();s.g.forChild(qt)}}]);