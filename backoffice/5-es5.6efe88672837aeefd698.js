(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{aCzL:function(t,e,n){"use strict";n.r(e);var c=n("TYT/"),i=n("Valr"),o=n("QJY3"),a=n("DUip"),r=n("pS6y"),s=n("mrSG"),d=n("UN3I"),u=n("OaWH"),l=n("C/ya"),h=n("D/9M"),m=n("g+Po"),p=n("QrbZ"),f=n("BAfr"),g=n("ZwpQ"),v=n("47y3"),b=n("5f3J"),_=n("2mMm"),y=n("0njA"),w=[1,"container"],C=[1,"select"],O=["mat-button","",3,"tapped"],M=["class","list",4,"ngIf"],P=["class","info-block",4,"ngIf"],I=[1,"list"],A=[1,"name"],k=[1,"flex"],x=[1,"scope"],S=[1,"duo"],T=[4,"ngFor","ngForOf"],D=["mat-icon-button","",3,"tapped"],E=[3,"icon"],R={class:"backoffice-edit"},U={class:"backoffice-trash"};function F(t,e){if(1&t){var n=c.fc();c.ec(0,"tr"),c.ec(1,"td",A),c.Tc(2),c.cc(),c.ec(3,"td",k),c.Tc(4),c.cc(),c.ec(5,"td",x),c.Tc(6),c.cc(),c.ec(7,"td",S),c.ec(8,"button",D),c.kc("tapped",function(t){c.Ec(n);var i=e.$implicit;return c.pc(2).editApplication(i)}),c.Yb(9,"app-icon",E),c.cc(),c.ec(10,"button",D),c.kc("tapped",function(t){c.Ec(n);var i=e.$implicit;return c.pc(2).deleteApplication(i)}),c.Yb(11,"app-icon",E),c.cc(),c.cc(),c.cc()}if(2&t){var i=e.$implicit;c.Ic(2),c.Uc(i.name),c.Ic(4),c.Uc(i.redirect),c.Ic(6),c.Uc(i.scope),c.Ic(9),c.vc("icon",R),c.Ic(11),c.vc("icon",U)}}function Y(t,e){if(1&t&&(c.ec(0,"div",I),c.ec(1,"table"),c.ec(2,"thead"),c.ec(3,"td",A),c.Tc(4,"Name"),c.cc(),c.ec(5,"td",k),c.Tc(6,"Redirect"),c.cc(),c.ec(7,"td",x),c.Tc(8,"Scope"),c.cc(),c.Yb(9,"td",S),c.cc(),c.ec(10,"tbody"),c.Rc(11,F,12,5,"tr",T),c.cc(),c.cc(),c.cc()),2&t){var n=c.pc();c.Ic(11),c.vc("ngForOf",n.application_list)}}var X=[1,"info-block"],N=[1,"text"];function j(t,e){1&t&&(c.ec(0,"div",X),c.ec(1,"div",N),c.Tc(2,"No applications found"),c.cc(),c.cc())}var q=function(t){function e(e,n){var c=t.call(this)||this;return c._service=e,c._dialog=n,c}return s.d(e,t),e.prototype.ngOnChanges=function(t){t.item&&this.loadApplications()},e.prototype.loadApplications=function(t){var e=this;void 0===t&&(t=0),this._service.Applications.query({owner:this.item.id,offset:t}).then(function(n){t||(e.application_list=[]);for(var c=0,i=n||[];c<i.length;c++){for(var o=i[c],a=!1,r=0,s=e.application_list;r<s.length;r++)if(s[r].id===o.id){a=!0;break}a||e.application_list.push(o)}},function(){return null})},e.prototype.newApplication=function(){this._dialog.open(h.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:new d.c(this._service.Applications,{}),service:this._service.Applications}})},e.prototype.editApplication=function(t){this.item&&this._dialog.open(h.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:t,service:this._service.Applications}})},e.prototype.deleteApplication=function(t){var e=this;if(t){var n=this._dialog.open(m.b,s.a({},m.a,{data:{title:"Delete application",content:"<p>Are you sure you want delete the application "+t.name+"?</p><p>Configuration will be <strong>immediately</strong> updated</p>",icon:{type:"icon",class:"backoffice-trash"}}}));this.subscription("delete_confirm",n.componentInstance.event.subscribe(function(c){"done"===c.reason&&(n.componentInstance.loading="Deleting application...",t.delete().then(function(){e._service.notifySuccess('Successfully deleted application "'+t.name+'".'),e.loadApplications(),n.close(),e.unsub("delete_confirm")},function(t){n.componentInstance.loading=null,e._service.notifyError("Error deleting application. Error: "+t)}))}))}},e.ngComponentDef=c.Rb({type:e,selectors:[["domain-applications"]],factory:function(t){return new(t||e)(c.Xb(u.a),c.Xb(p.b))},inputs:{item:"item"},features:[c.Fb,c.Gb()],consts:7,vars:2,template:function(t,e){1&t&&(c.ec(0,"div",w),c.ec(1,"section",C),c.ec(2,"button",O),c.kc("tapped",function(t){return e.newApplication()}),c.Tc(3,"Add new"),c.cc(),c.cc(),c.ec(4,"section"),c.Rc(5,Y,12,1,"div",M),c.Rc(6,j,3,0,"div",P),c.cc(),c.cc()),2&t&&(c.Ic(5),c.vc("ngIf",e.application_list&&e.application_list.length>0),c.Ic(6),c.vc("ngIf",!e.application_list||e.application_list.length<=0))},directives:[_.b,g.b,i.n,i.m,y.a],styles:[".container[_ngcontent-%COMP%]{padding:1em}.options[_ngcontent-%COMP%]{display:flex;font-size:1.2em;max-width:5em;margin:0}.state[_ngcontent-%COMP%]{height:1.5em;width:1.5em;margin:.25em;background-color:#000;border-radius:.8em;transition:margin 250ms,height 250ms,width 250ms,background-color .3s}.state.active[_ngcontent-%COMP%]{background-color:#4caf50;height:.75em;width:.75em;margin:.625em}.duo[_ngcontent-%COMP%]{width:6em}.table-row[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%], .table-row[_ngcontent-%COMP%]   .scope[_ngcontent-%COMP%]{width:8em;min-width:8em}.select[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}section[_ngcontent-%COMP%]{padding:.5em .25em}"]}),e}(b.a),z=n("dQMc"),$=[1,"container"],B=[1,"select"],H=["mat-button","",3,"tapped"],L=["class","list",4,"ngIf","ngIfElse"],Q=["no_auth_sources",""],W=[1,"list"],G=[1,"name"],J=[1,"flex"],V=[1,"duo"],Z=[4,"ngFor","ngForOf"],K=["mat-icon-button","",3,"tapped"],tt=[3,"icon"],et={class:"backoffice-edit"},nt={class:"backoffice-trash"};function ct(t,e){if(1&t){var n=c.fc();c.ec(0,"tr"),c.ec(1,"td",G),c.Tc(2),c.cc(),c.ec(3,"td",J),c.Tc(4),c.cc(),c.ec(5,"td",V),c.ec(6,"button",K),c.kc("tapped",function(t){c.Ec(n);var i=e.$implicit;return c.pc(2).editAuthSource(i)}),c.Yb(7,"app-icon",tt),c.cc(),c.ec(8,"button",K),c.kc("tapped",function(t){c.Ec(n);var i=e.$implicit;return c.pc(2).deleteAuthSource(i)}),c.Yb(9,"app-icon",tt),c.cc(),c.cc(),c.cc()}if(2&t){var i=e.$implicit,o=c.pc(2);c.Ic(2),c.Uc(i.name),c.Ic(4),c.Uc(o.source_types[i.id]),c.Ic(7),c.vc("icon",et),c.Ic(9),c.vc("icon",nt)}}function it(t,e){if(1&t&&(c.ec(0,"div",W),c.ec(1,"table"),c.ec(2,"thead"),c.ec(3,"td",G),c.Tc(4,"Name"),c.cc(),c.ec(5,"td",J),c.Tc(6,"Type"),c.cc(),c.Yb(7,"td",V),c.cc(),c.ec(8,"tbody"),c.Rc(9,ct,10,4,"tr",Z),c.cc(),c.cc(),c.cc()),2&t){var n=c.pc();c.Ic(9),c.vc("ngForOf",n.auth_sources)}}var ot=[1,"info-block"],at=[1,"text"];function rt(t,e){1&t&&(c.ec(0,"div",ot),c.ec(1,"div",at),c.Tc(2,"No authentication sources found"),c.cc(),c.cc())}var st=function(t){function e(e,n){var c=t.call(this)||this;return c._service=e,c._dialog=n,c.auth_sources=[],c.source_types={},c}return s.d(e,t),e.prototype.ngOnChanges=function(t){t.item&&this.loadAuthSources()},e.prototype.loadAuthSources=function(t){var e=this;void 0===t&&(t=0),Promise.all([this._service.OAuthSources.query({authority_id:this.item.id,offset:t}),this._service.SAMLAuthSources.query({authority_id:this.item.id,offset:t}),this._service.LDAPAuthSources.query({authority_id:this.item.id,offset:t})]).then(function(n){t||(e.auth_sources=[]);for(var c=0,i=n;c<i.length;c++)i[c].forEach(function(t){return e.addAuthSourceToList(t)})},function(){return null})},e.prototype.newAuthSource=function(){var t=this;this._dialog.open(z.a,{width:"auto",height:"auto",data:{domain:this.item}}).afterClosed().subscribe(function(){return t.loadAuthSources()})},e.prototype.editAuthSource=function(t){var e=this;this._dialog.open(z.a,{width:"auto",height:"auto",data:{domain:this.item,auth_source:t}}).afterClosed().subscribe(function(){return e.loadAuthSources()})},e.prototype.deleteAuthSource=function(t){var e=this;if(t){var n=this._dialog.open(m.b,s.a({},m.a,{data:{title:"Delete auth source",content:"<p>Are you sure you want delete this auth source?</p><p>Deleting this will device <strong>immediately</strong> remove it from any system associated with it</p>",icon:{type:"icon",class:"backoffice-trash"}}}));this.subscription("delete_confirm",n.componentInstance.event.subscribe(function(c){"done"===c.reason&&(n.componentInstance.loading="Deleting auth source...",t.delete().then(function(){e._service.notifySuccess("Successfully deleted auth source."),n.close(),e.unsub("delete_confirm"),e.loadAuthSources()},function(t){e._service.notifyError("Error deleting auth source. Error "+(t.message||t)),n.componentInstance.loading=null}))}))}},e.prototype.addAuthSourceToList=function(t){this.source_types[t.id]=t instanceof d.l?"saml":t instanceof d.g?"ldap":"oauth";var e=this.auth_sources.findIndex(function(e){return e.id===t.id});e<0?this.auth_sources.push(t):this.auth_sources.splice(e,1,t)},e.ngComponentDef=c.Rb({type:e,selectors:[["domain-authentication"]],factory:function(t){return new(t||e)(c.Xb(u.a),c.Xb(p.b))},inputs:{item:"item"},features:[c.Fb,c.Gb()],consts:8,vars:2,template:function(t,e){if(1&t&&(c.ec(0,"div",$),c.ec(1,"section",B),c.ec(2,"button",H),c.kc("tapped",function(t){return e.newAuthSource()}),c.Tc(3,"Add new"),c.cc(),c.cc(),c.ec(4,"section"),c.Rc(5,it,10,1,"div",L),c.cc(),c.cc(),c.Rc(6,rt,3,0,"ng-template",null,Q,c.Sc)),2&t){var n=c.Bc(7);c.Ic(5),c.vc("ngIf",e.auth_sources&&e.auth_sources.length>0)("ngIfElse",n)}},directives:[_.b,g.b,i.n,i.m,y.a],styles:[".container[_ngcontent-%COMP%]{padding:1em}.options[_ngcontent-%COMP%]{display:flex;font-size:1.2em;max-width:5em;margin:0}.action[_ngcontent-%COMP%]{height:1.5em;width:1.5em;min-width:1.5em;border-radius:.65em;display:flex;align-items:center;justify-content:center;font-size:1.3em}.action[_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.1)}.table-row[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{width:8em;min-width:8em}.state[_ngcontent-%COMP%]{height:1.5em;width:1.5em;margin:.25em;background-color:#000;border-radius:.8em;transition:margin 250ms,height 250ms,width 250ms,background-color .3s}.state.active[_ngcontent-%COMP%]{background-color:#4caf50;height:.75em;width:.75em;margin:.625em}.select[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}section[_ngcontent-%COMP%]{padding:.5em .25em}.duo[_ngcontent-%COMP%]{width:6em;text-align:right}"]}),e}(b.a),dt=[1,"container"],ut=["class","list",4,"ngIf"],lt=["class","info-block",4,"ngIf"],ht=[1,"list"],mt=[1,"name"],pt=[1,"flex"],ft=[1,"role"],gt=[4,"ngFor","ngForOf"];function vt(t,e){if(1&t&&(c.ec(0,"tr"),c.ec(1,"td",mt),c.Tc(2),c.cc(),c.ec(3,"td",pt),c.Tc(4),c.cc(),c.ec(5,"td",ft),c.Tc(6),c.cc(),c.cc()),2&t){var n=e.$implicit;c.Ic(2),c.Uc(n.name),c.Ic(4),c.Uc(n.email),c.Ic(6),c.Uc(n.role)}}function bt(t,e){if(1&t&&(c.ec(0,"div",ht),c.ec(1,"table"),c.ec(2,"thead"),c.ec(3,"td",mt),c.Tc(4,"Name"),c.cc(),c.ec(5,"td",pt),c.Tc(6,"Email"),c.cc(),c.ec(7,"td",ft),c.Tc(8,"Role"),c.cc(),c.cc(),c.ec(9,"tbody"),c.Rc(10,vt,7,3,"tr",gt),c.cc(),c.cc(),c.cc()),2&t){var n=c.pc();c.Ic(10),c.vc("ngForOf",n.model.list)}}var _t=[1,"info-block"],yt=[1,"text"];function wt(t,e){1&t&&(c.ec(0,"div",_t),c.ec(1,"div",yt),c.Tc(2,"No users found"),c.cc(),c.cc())}var Ct=function(t){function e(e){var n=t.call(this)||this;return n.service=e,n.model={},n}return s.d(e,t),e.prototype.ngOnInit=function(){this.load()},e.prototype.ngOnChanges=function(t){t.item&&this.load()},e.prototype.load=function(t){var e=this;void 0===t&&(t=0),this.service.Users.query({authority_id:this.item.id,offset:t}).then(function(n){t||(e.model.list=[]);for(var c=0,i=n||[];c<i.length;c++){for(var o=i[c],a=!1,r=0,s=e.model.list;r<s.length;r++)if(s[r].id===o.id){a=!0;break}a||e.model.list.push(o)}},function(){return null})},e.ngComponentDef=c.Rb({type:e,selectors:[["domain-users"]],factory:function(t){return new(t||e)(c.Xb(u.a))},inputs:{item:"item"},features:[c.Fb,c.Gb()],consts:4,vars:2,template:function(t,e){1&t&&(c.ec(0,"div",dt),c.ec(1,"section"),c.Rc(2,bt,11,1,"div",ut),c.Rc(3,wt,3,0,"div",lt),c.cc(),c.cc()),2&t&&(c.Ic(2),c.vc("ngIf",e.model.list&&e.model.list.length>0),c.Ic(3),c.vc("ngIf",!e.model.list||e.model.list.length<=0))},directives:[i.n,i.m],styles:[".container[_ngcontent-%COMP%]{padding:1em}.options[_ngcontent-%COMP%]{display:flex;font-size:1.2em;max-width:5em;margin:0}.action[_ngcontent-%COMP%]{height:1.5em;width:1.5em;min-width:1.5em;border-radius:.65em;display:flex;align-items:center;justify-content:center;font-size:1.3em}.action[_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.1)}.table-row[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{width:12em;min-width:12em}.table-row[_ngcontent-%COMP%]   .role[_ngcontent-%COMP%]{width:8em;min-width:8em}.state[_ngcontent-%COMP%]{height:1.5em;width:1.5em;margin:.25em;background-color:#000;border-radius:.8em;transition:margin 250ms,height 250ms,width 250ms,background-color .3s}.state.active[_ngcontent-%COMP%]{background-color:#4caf50;height:.75em;width:.75em;margin:.625em}.select[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}section[_ngcontent-%COMP%]{padding:.5em .25em}"]}),e}(b.a),Ot=[1,"container"],Mt=[1,"sidebar"],Pt=["heading","Domains",3,"module","close","searchChange","event"],It=[3,"touchrelease"],At=["name","zone",3,"item","active","tabs","event"],kt=["apps",""],xt=["auth",""],St=["users",""],Tt=[3,"item"];function Dt(t,e){if(1&t&&c.Yb(0,"domain-applications",Tt),2&t){var n=c.pc();c.vc("item",n.item)}}function Et(t,e){if(1&t&&c.Yb(0,"domain-authentication",Tt),2&t){var n=c.pc();c.vc("item",n.item)}}function Rt(t,e){if(1&t&&c.Yb(0,"domain-users",Tt),2&t){var n=c.pc();c.vc("item",n.item)}}var Ut={class:"backoffice-publish"},Ft=function(t,e){return{id:"applications",name:"Applications",count:t,template:e,icon:Ut}},Yt={class:"backoffice-lock-open"},Xt=function(t,e){return{id:"authentication",name:"Authentication",count:t,template:e,icon:Yt}},Nt={class:"backoffice-users"},jt=function(t,e){return{id:"users",name:"Users",count:t,template:e,icon:Nt}},qt=function(t,e,n){return[t,e,n]},zt=function(t){function e(e,n,c,i){var o=t.call(this,e,n,c)||this;return o._service=e,o._route=n,o._router=c,o._dialog=i,o.service=o._service.Domains,o}return s.d(e,t),e.prototype.loadValues=function(){var t=this,e={offset:0,limit:1,owner:this.item.id};this._service.Applications.query(e).then(function(){return t.applications=t._service.Applications.last_total}),this._service.Users.query(e={offset:0,limit:1,authority_id:this.item.id}).then(function(){return t.user_count=t._service.Users.last_total})},e.prototype.new=function(){this._dialog.open(h.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:new d.e(this._service.Domains,{}),service:this._service.Domains}})},e.prototype.edit=function(){this.item&&this._dialog.open(h.a,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:this.item,service:this._service.Domains}})},e.prototype.delete=function(){var t=this;if(this.item){var e=this._dialog.open(m.b,s.a({},m.a,{data:{title:"Delete domain",content:"<p>Are you sure you want delete this domain?</p><p>The domain will be deleted <strong>immediately.</strong></p>",icon:{type:"icon",class:"backoffice-trash"}}}));this.subscription("delete_confirm",e.componentInstance.event.subscribe(function(n){"done"===n.reason&&(e.componentInstance.loading="Deleting domain...",t.item.delete().then(function(){t._service.notifySuccess('Successfully deleted domain "'+t.item.name+'".'),t._router.navigate(["/users"]),e.close(),t.unsub("delete_confirm")},function(n){e.componentInstance.loading=null,t._service.notifyError("Error deleting domain. Error: "+n)}))}))}},e.ngComponentDef=c.Rb({type:e,selectors:[["app-domains"]],factory:function(t){return new(t||e)(c.Xb(u.a),c.Xb(a.a),c.Xb(a.c),c.Xb(p.b))},features:[c.Fb],consts:11,vars:19,template:function(t,e){if(1&t&&(c.ec(0,"div",Ot),c.Pc(),c.ec(1,"div",Mt),c.ec(2,"sidebar",Pt),c.kc("searchChange",function(t){return e.search(t)}),c.kc("event",function(t){return e.sidebarEvent(t)}),c.cc(),c.cc(),c.ec(3,"main",It),c.kc("touchrelease",function(t){return e.show_sidebar=!1}),c.ec(4,"item-display",At),c.kc("event",function(t){return e.itemEvent(t)}),c.Rc(5,Dt,1,1,"ng-template",null,kt,c.Sc),c.Rc(7,Et,1,1,"ng-template",null,xt,c.Sc),c.Rc(9,Rt,1,1,"ng-template",null,St,c.Sc),c.cc(),c.cc(),c.cc()),2&t){var n=c.Bc(6),i=c.Bc(8),o=c.Bc(10);c.Mb("show",e.show_sidebar),c.Qc(),c.Ic(2),c.vc("module",e.module)("close",e.show_sidebar),c.Ic(4),c.vc("item",e.item)("active",e.tab)("tabs",c.yc(15,qt,c.xc(6,Ft,e.applications||0,n),c.xc(9,Xt,e.auth_sources||0,i),c.xc(12,jt,e.user_count||0,o)))}},directives:[f.a,g.b,v.a,q,st,Ct],styles:[".container[_ngcontent-%COMP%]{display:flex;align-items:center;height:100%;width:100%}.sidebar[_ngcontent-%COMP%]{height:100%;width:20em}@media only screen and (orientation:portrait) and (max-width:450px){.container[_ngcontent-%COMP%]{flex-direction:column}.container.show[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{height:100%}.container.show[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{height:0%}.sidebar[_ngcontent-%COMP%]{height:3em;min-height:3em;width:100%;transition:height .3s}main[_ngcontent-%COMP%]{transition:height .3s;width:100%}}@media only screen and (orientation:landscape) and (max-width:800px){.container[_ngcontent-%COMP%]{flex-direction:column}.container.show[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{height:100%}.container.show[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{height:0%}.sidebar[_ngcontent-%COMP%]{height:3em;min-height:3em;width:100%;transition:height .3s}main[_ngcontent-%COMP%]{transition:height .3s;width:100%}}main[_ngcontent-%COMP%]{position:relative;height:100%;overflow:hidden;flex:1;background-color:#f0f0f0}"]}),e}(l.a),$t=[{path:"",component:zt,children:[]},{path:":id",component:zt,children:[]},{path:"**",redirectTo:""}],Bt=n("PCNd");n.d(e,"AppDomainsModule",function(){return Ht});var Ht=function(){function t(){}return t.ngModuleDef=c.Vb({type:t}),t.ngInjectorDef=c.Ub({factory:function(e){return new(e||t)},imports:[[i.c,o.g,r.b,a.g.forChild($t),Bt.a]]}),t}();a.g.forChild($t)}}]);